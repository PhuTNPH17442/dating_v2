!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(kd){"use strict";try{!function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(kd),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function y(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function g(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}var a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,o=(3&o)<<4|a>>4,a=(15&a)<<2|c>>6,c=63&c;u||(c=64,s||(a=64)),r.push(n[h],n[o],n[a],n[c])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i,o,s,a=t[n++];a<128?e[r++]=String.fromCharCode(a):191<a&&a<224?(o=t[n++],e[r++]=String.fromCharCode((31&a)<<6|63&o)):239<a&&a<365?(i=((7&a)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536,e[r++]=String.fromCharCode(55296+(i>>10)),e[r++]=String.fromCharCode(56320+(1023&i))):(o=t[n++],s=t[n++],e[r++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s))}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();o=o<<2|s>>4;r.push(o),64!==a&&(s=s<<4&240|a>>2,r.push(s),64!==u&&(u=a<<6&192|u,r.push(u)))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var i,u="FirebaseError",c=(n(l,i=Error),l);function l(t,e,n){e=i.call(this,e)||this;return e.code=t,e.customData=n,e.name=u,Object.setPrototypeOf(e,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,f.prototype.create),e}var f=(p.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(v,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new c(o,t,i)},p);function p(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var d,v=/\{\$([^}]+)}/g;function m(t){return t&&t._delegate?t._delegate:t}(Ie=d=d||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function b(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=E[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var w={debug:d.DEBUG,verbose:d.VERBOSE,info:d.INFO,warn:d.WARN,error:d.ERROR,silent:d.SILENT},_=d.INFO,E=((Se={})[d.DEBUG]="log",Se[d.VERBOSE]="log",Se[d.INFO]="info",Se[d.WARN]="warn",Se[d.ERROR]="error",Se),T=(Object.defineProperty(I.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in d))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),I.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?w[t]:t},Object.defineProperty(I.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),I.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.DEBUG],t)),this._logHandler.apply(this,s([this,d.DEBUG],t))},I.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.VERBOSE],t)),this._logHandler.apply(this,s([this,d.VERBOSE],t))},I.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.INFO],t)),this._logHandler.apply(this,s([this,d.INFO],t))},I.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.WARN],t)),this._logHandler.apply(this,s([this,d.WARN],t))},I.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,d.ERROR],t)),this._logHandler.apply(this,s([this,d.ERROR],t))},I);function I(t){this.name=t,this._logLevel=_,this._logHandler=b,this._userLogHandler=null}var S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},C={},R=D||self;function k(){}function O(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),M=0;function x(t,e,n){return t.call.apply(t.bind,arguments)}function F(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?x:F).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function q(){return Date.now()}function B(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,P)&&t[P]||(t[P]=++M))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var z,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var $=R.navigator;if($){$=$.userAgent;if($){z=$;break t}}z=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e,n={};for(e in t)n[e]=t[e];return n}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<et.length;i++)e=et[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function rt(t){return rt[" "](t),t}rt[" "]=k;var it,ot=X(z,"Opera"),st=X(z,"Trident")||X(z,"MSIE"),at=X(z,"Edge"),ut=at||st,ct=X(z,"Gecko")&&!(X(z.toLowerCase(),"webkit")&&!X(z,"Edge"))&&!(X(z,"Trident")||X(z,"MSIE"))&&!X(z,"Edge"),ht=X(z.toLowerCase(),"webkit")&&!X(z,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var ft="",pt=(pt=z,ct?/rv:([^\);]+)(\)|;)/.exec(pt):at?/Edge\/([\d\.]+)/.exec(pt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(pt):ht?/WebKit\/(\S+)/.exec(pt):ot?/(?:Version)[ \/]?(\S+)/.exec(pt):void 0);if(pt&&(ft=pt?pt[1]:""),st){pt=lt();if(null!=pt&&pt>parseFloat(ft)){it=String(pt);break t}}it=ft}var dt={};function yt(a){return t=a,e=function(){for(var t=0,e=Y(String(it)).split("."),n=Y(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var gt=R.document&&st&&(lt()||parseInt(it,10))||void 0,vt=!st||9<=Number(gt),mt=st&&!yt("9"),bt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",k,e),R.removeEventListener("test",k,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},B(_t,wt);var Et={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),It=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ct(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ct(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new St(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),kt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[Tt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Tt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!vt)return null;var a,u,c=Vt(t);if(c||(t[Rt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=vt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=!bt?s:i)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Rt]=null)):At(t)))}function Mt(t){return t in kt?kt[t]:kt[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(vt)return xt(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new _t(e,this))}function Vt(t){return(t=t[Rt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Bt(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new wt(e,t):e instanceof wt?e.target=e.target||t:(s=e,nt(e=new wt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Gt(o,r,!0,e)&&s;if(s=Gt(o=e.a=t,r,!0,e)&&s,s=Gt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Gt(o=e.a=n[i],r,!1,e)&&s}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Dt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}B(Bt,j),Bt.prototype[Tt]=!0,(N=Bt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=qt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ct(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?Ct(n,r,i,o):e)?n[e]:null)&&Pt(r))}(this,t,e,n,r)},N.G=function(){if(Bt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=R.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,Qt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Yt},function(t){t.reset()}));function zt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Yt(){this.next=this.b=this.a=null}function Xt(t,e){var n;Wt||(n=R.Promise.resolve(void 0),Wt=function(){n.then(Zt)}),Jt||(Wt(),Jt=!0),$t.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Yt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Jt=!(Yt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Ht;function Zt(){for(var t,e;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){R.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Jt=!1}function te(t,e){Bt.call(this),this.b=t||1,this.a=e||R,this.f=V(this.Za,this),this.g=q()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==typeof t)n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}B(te,Bt),(N=te.prototype).aa=!1,N.M=null,N.Za=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),jt(this,"tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},N.G=function(){te.X.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(S(ie=ue,oe=re=j),ie.prototype=null===oe?Object.create(oe):(ae.prototype=oe.prototype,new ae),ue.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ue.prototype.G=function(){re.prototype.G.call(this),this.a&&(R.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ue);function ae(){this.constructor=ie}function ue(t,e){var n=re.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ce(t){j.call(this),this.b=t,this.a={}}B(ce,j);var he=[];function le(t,e,n,r){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ce.prototype.G=function(){ce.X.G.call(this),fe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye={},ge=null;function ve(){return ge=ge||new Bt}function me(t){wt.call(this,ye.Fa,t)}function be(t){var e=ve();jt(e,new me(e))}function we(t,e){wt.call(this,ye.STAT_EVENT,t),this.stat=e}function _e(t){var e=ve();jt(e,new we(e,t))}function Ee(t){wt.call(this,ye.Ga,t)}function Te(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}ye.Fa="serverreachability",B(me,wt),ye.STAT_EVENT="statevent",B(we,wt),ye.Ga="timingevent",B(Ee,wt);var Ie={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Se={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ae(){}function Ne(t){var e;return e=!(e=t.a)?t.a={}:e}function De(){}Ae.prototype.a=null;D={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ce(){wt.call(this,"d")}function Re(){wt.call(this,"c")}function ke(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ce(this),this.P=Pe,t=ut?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}B(Ce,wt),B(Re,wt),B(ke,Ae);var Le=new ke,Pe=45e3,Me={},xe={};function Fe(t,e,n){t.H=1,t.i=on($e(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=q(),qe(t),t.l=$e(t.i);var s,a,u,c,h,l,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=lr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(V(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Xa),e=t.B?tt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(1),s=t.c,a=t.m,u=t.l,c=t.f,h=t.S,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+a+"\n"+u+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var a=(a=n,o=i=void 0,i=(r=t).D,-1==(o=a.indexOf("\n",i))?xe:(i=Number(a.substring(i,o)),isNaN(i)?Me:(o+=1)+i>a.length?xe:(a=a.substr(o,i),r.D=o+i,a)));if(a==xe){4==e&&(t.h=4,_e(14),s=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Me){t.h=4,_e(15),de(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}de(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,_e(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0,_e(11))):(de(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),Ge(t))}function qe(t){t.T=q()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(V(t.Va,t),e)}function je(t){t.o&&(R.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||sr(t.g,t)}function Ke(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,a=t.g;if(0!=a.v&&(a.a==t||Sn(a.b,t)))if(a.I=t.N,!t.C&&Sn(a.b,t)&&3==a.v){try{var u=a.ka.a.parse(e)}catch(t){u=null}if(Array.isArray(u)&&3==u.length){var c=u;if(0==c[0]){t:if(!a.j){if(a.a){if(!(a.a.u+3e3<t.u))break t;or(a),zn(a)}nr(a),_e(18)}}else a.oa=c[1],0<a.oa-a.P&&c[2]<37500&&a.H&&0==a.o&&!a.m&&(a.m=Te(V(a.Sa,a),6e3));if(In(a.b)<=1&&a.ea){try{a.ea()}catch(t){}a.ea=void 0}}else ur(a,11)}else if(!t.C&&a.a!=t||or(a),!Q(e))for(e=u=a.ka.a.parse(e),u=0;u<e.length;u++)c=e[u],a.P=c[0],c=c[1],2==a.v?"c"==c[0]?(a.J=c[1],a.ga=c[2],null!=(r=c[3])&&(a.ha=r,a.c.info("VER="+a.ha)),null!=(o=c[4])&&(a.pa=o,a.c.info("SVER="+a.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,a.D=n,a.c.info("backChannelRequestTimeoutMs_="+n)),n=a,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(An(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,rn(n.B,n.A,s))),a.v=3,a.f&&a.f.ta(),a.U&&(a.N=q()-t.u,a.c.info("Handshake RTT: "+a.N+"ms")),i=t,(n=a).la=hr(n,n.C?n.ga:null,n.fa),i.C?(Nn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),qe(o)),n.a=i):er(n),0<a.g.length&&Jn(a)):"stop"!=c[0]&&"close"!=c[0]||ur(a,7):3==a.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ur(a,7):Qn(a):"noop"!=c[0]&&a.f&&a.f.sa(c),a.o=0);be(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)K(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t)for(var n=[],r=t.length,i=0;i<r;i++)n.push(i);else for(i in n=[],r=0,t)n[r++]=i;for(var i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ye(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ye(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Xa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||be(8==n||r<=0?3:2),je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,u=this.m,c=this.l,h=this.f,l=this.S,f=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+l+"]: "+u+"\n"+c+"\n"+f+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,_e(12),Ke(this),Ge(this);break t}de(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,a)}this.I?(Ue(this,e,o),ut&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Wa),this.R.start())):(de(this.c,this.f,o,null),He(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,qe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,_e(12)):(this.h=0,_e(13)),Ke(this),Ge(this)}}}catch(t){}var u,c,h,l,f,p},N.Wa=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ue(this,t,e),this.b&&4!=t&&qe(this)))},N.cancel=function(){this.A=!0,Ke(this)},N.Va=function(){this.o=null;var t,e,n=q();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(3),_e(17)),Ke(this),this.h=2,Ge(this)):Be(this,this.T-n)},(N=Qe.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},N.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Je?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Xe))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function $e(t){return new Je(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=an(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(an(e,cn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",an(n,pn)),t.join("")};var cn=/[#\/\?@]/g,hn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){yn(t),e=bn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function vn(t,e){return yn(t),e=bn(t,e),Ye(t.a.b,e)}function mn(t,e,n){gn(t,e),0<n.length&&(t.c=null,t.a.set(bn(t,e),W(n)),t.b+=n.length)}function bn(t,e){return e=String(e),e=t.f?e.toLowerCase():e}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=bn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){K(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=H(e,this.a.get(bn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,vn(this,t=bn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=function(t,e){this.b=t,this.a=e};function _n(t){this.g=t||En,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ia&&R.ia.ya&&R.ia.ya()&&R.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var En=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Cn(){}function Rn(){this.a=new Cn}function kn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}_n.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Cn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Cn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var On=R.JSON.parse;function Ln(t){Bt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}B(Ln,Bt);var Pn="",Mn=/^https?$/i,xn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Bn(t)}function Un(t){t.u||(t.u=!0,jt(t,"complete"),jt(t,"error"))}function qn(t){if(t.b&&void 0!==C&&(!t.s[1]||4!=Gn(t)||2!=t.W()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(jt(t,"readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}(e=s)||((n=0===o)&&(!(i=String(t.B).match(Xe)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n);if(e)jt(t,"complete"),jt(t,"success");else{t.h=6;try{var a=2<Gn(t)?t.a.statusText:""}catch(o){a=""}t.f=a+" ["+t.W()+"]",Un(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?k:null;t.a=null,t.s=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Hn("baseRetryDelayMs",5e3,t),this.Ra=Hn("retryDelaySeedMs",1e4,t),this.Ma=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new _n(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Qn(t){var e,n;Yn(t),3==t.v&&(e=t.R++,rn(n=$e(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=on($e(n)),n=!1,!(n=R.navigator&&R.navigator.sendBeacon?R.navigator.sendBeacon(e.i.toString(),""):n)&&R.Image&&((new Image).src=e.i,n=!0),n||(e.a=lr(e.g,null),e.a.ba(e.i)),e.u=q(),qe(e)),cr(t)}function zn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Yn(t){zn(t),t.j&&(R.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&R.clearTimeout(t.h),t.h=null)}function Xn(t,e){t.g.push(new wn(t.Oa++,e)),3==t.v&&Jn(t)}function Jn(t){Tn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function $n(t,e){var n=e?e.f:t.R++,r=$e(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),Zn(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Fe(n,r,e)}function Zn(t,n){t.f&&We({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r,e){var i=e||"";try{We(t,function(t,e){var n=t;L(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.T=1,Xt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=Te(V(t.Aa,t),ar(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(R.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=$e(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on($e(e)),n.j=null,n.I=!0,Ve(n,t)}function or(t){null!=t.m&&(R.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r,i,o=null;if(t.a==e){or(t),rr(t),t.a=null;var s=2}else{if(!Sn(t.b,e))return;o=e.s,Nn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=q()-e.u,n=t.u,jt(s=ve(),new Ee(s)),Jn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,In((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=Te(V(r.Ba,r,i),ar(r,r.u)),r.u++,0))))&&(2!=s||!nr(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function ar(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ur(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Ya,t),r||(r=new Je("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Ze(r,"https"),on(r)),n=r.toString(),r=o,o=new pe,R.Image?((i=new Image).onload=U(kn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(kn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(kn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(kn,o,i,"TestLoadImage: timeout",!1,r),R.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):_e(2),t.v=0,t.f&&t.f.ra(e),cr(t),Yn(t)}function cr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function hr(t,e,n){var r,i,o,s,a,u=(s=n)instanceof Je?$e(s):new Je(s,void 0);return""!=u.c?(e&&tn(u,e+"."+u.c),en(u,u.h)):(a=R.location,r=a.protocol,i=e?e+"."+a.hostname:a.hostname,o=+a.port,s=n,a=new Je(null,void 0),r&&Ze(a,r),i&&tn(a,i),o&&en(a,o),s&&(a.g=s),u=a),t.V&&Z(t.V,function(t,e){rn(u,e,t)}),e=t.A,n=t.na,e&&n&&rn(u,e,n),rn(u,"VER",t.ha),Zn(t,u),u}function lr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Na)).F=t.C,e}function fr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Bt.call(this),this.a=new Wn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new vr(this)}function yr(t){Ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function gr(){Re.call(this),this.status=1}function vr(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(Le),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=R.FormData&&t instanceof R.FormData,0<=G(xn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,st&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==C&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,jt(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,jt(this,"complete"),jt(this,"abort"),Bn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Ln.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ua())},N.Ua=function(){qn(this)},N.W=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?nt(r=tt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=$e(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),Zn(this,i),this.i&&r&&Kn(i,this.i,r),An(this.b,n),this.Ia&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.U=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?$n(this,t):0==this.g.length||Tn(this.b)||$n(this))},N.Aa=function(){var t;this.j=null,ir(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(V(this.Ta,this),t))},N.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,_e(10),zn(this),ir(this))},N.Sa=function(){null!=this.m&&(this.m=null,zn(this),nr(this),_e(19))},N.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),_e(2)):(this.c.info("Failed to ping google.com"),_e(1))},(N=fr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ja=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},B(dr,Bt),dr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;_e(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=hr(t,null,t.fa),Jn(t)},dr.prototype.close=function(){Qn(this.a)},dr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Xn(this.a,e)):this.l?((e={}).__data__=Kt(t),Xn(this.a,e)):Xn(this.a,t)},dr.prototype.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,dr.X.G.call(this)},B(yr,Ce),B(gr,Re),B(vr,fr),vr.prototype.ta=function(){jt(this.a,"a")},vr.prototype.sa=function(t){jt(this.a,new yr(t))},vr.prototype.ra=function(t){jt(this.a,new gr)},vr.prototype.qa=function(){jt(this.a,"b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.h,dr.prototype.open=dr.prototype.g,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Se.COMPLETE="complete",(De.EventType=D).OPEN="a",D.CLOSE="b",D.ERROR="c",D.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.W,Ln.prototype.getResponseJson=Ln.prototype.Pa,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var mr=ve,br=Ie,wr=Se,_r=ye,Er=10,Tr=11,Ir=De,Sr=Ln,Ar="8.5.0-20214541157",Nr=(Dr.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Dr.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},Dr);function Dr(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}Nr.o=-1;var Cr,Rr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},kr=(n(Lr,Cr=Error),Lr),Or=new T("@firebase/firestore");function Lr(t,e){var n=this;return(n=Cr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Pr(){return Or.logLevel}function Mr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=d.DEBUG&&(e=n.map(Vr),Or.debug.apply(Or,s(["Firestore ("+Ar+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=d.ERROR&&(e=n.map(Vr),Or.error.apply(Or,s(["Firestore ("+Ar+"): "+t],e)))}function Fr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Or.logLevel<=d.WARN&&(e=n.map(Vr),Or.warn.apply(Or,s(["Firestore ("+Ar+"): "+t],e)))}function Vr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ur(t){t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t);throw xr(t),new Error(t)}function qr(t){t||Ur()}var Br=(jr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},jr);function jr(){}function Gr(t,e){return t<e?-1:e<t?1:0}function Kr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Hr=(zr.now=function(){return zr.fromMillis(Date.now())},zr.fromDate=function(t){return zr.fromMillis(t.getTime())},zr.fromMillis=function(t){var e=Math.floor(t/1e3);return new zr(e,Math.floor(1e6*(t-1e3*e)))},zr.prototype.toDate=function(){return new Date(this.toMillis())},zr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},zr.prototype._compareTo=function(t){return this.seconds===t.seconds?Gr(this.nanoseconds,t.nanoseconds):Gr(this.seconds,t.seconds)},zr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},zr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},zr.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},zr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},zr),Wr=(Qr.fromTimestamp=function(t){return new Qr(t)},Qr.min=function(){return new Qr(new Hr(0,0))},Qr.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},Qr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Qr.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Qr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Qr.prototype.toTimestamp=function(){return this.timestamp},Qr);function Qr(t){this.timestamp=t}function zr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new kr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new kr(Rr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new kr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new kr(Rr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Yr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Xr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var $r,Zr,Se=(Object.defineProperty(ci.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),ci.prototype.isEqual=function(t){return 0===ci.comparator(this,t)},ci.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ci?t.forEach(function(t){e.push(t)}):e.push(t),this.construct(e)},ci.prototype.limit=function(){return this.offset+this.length},ci.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},ci.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},ci.prototype.firstSegment=function(){return this.segments[this.offset]},ci.prototype.lastSegment=function(){return this.get(this.length-1)},ci.prototype.get=function(t){return this.segments[this.offset+t]},ci.prototype.isEmpty=function(){return 0===this.length},ci.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ci.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ci.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},ci.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ci),ti=(n(ui,Zr=Se),ui.prototype.construct=function(t,e,n){return new ui(t,e,n)},ui.prototype.canonicalString=function(){return this.toArray().join("/")},ui.prototype.toString=function(){return this.canonicalString()},ui.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new kr(Rr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new ui(n)},ui.emptyPath=function(){return new ui([])},ui),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(ai,$r=Se),ai.prototype.construct=function(t,e,n){return new ai(t,e,n)},ai.isValidIdentifier=function(t){return ei.test(t)},ai.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t=!ai.isValidIdentifier(t)?"`"+t+"`":t}).join(".")},ai.prototype.toString=function(){return this.canonicalString()},ai.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},ai.keyField=function(){return new ai(["__name__"])},ai.fromServerFormat=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new kr(Rr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new kr(Rr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new kr(Rr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new kr(Rr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ai(e)},ai.emptyPath=function(){return new ai([])},ai),ri=(si.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},si.prototype.isEqual=function(t){return Kr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},si),ii=(oi.fromBase64String=function(t){return new oi(atob(t))},oi.fromUint8Array=function(t){return new oi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},oi.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},oi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},oi.prototype.approximateByteSize=function(){return 2*this.binaryString.length},oi.prototype.compareTo=function(t){return Gr(this.binaryString,t.binaryString)},oi.prototype.isEqual=function(t){return this.binaryString===t.binaryString},oi);function oi(t){this.binaryString=t}function si(t){(this.fields=t).sort(ni.comparator)}function ai(){return null!==$r&&$r.apply(this,arguments)||this}function ui(){return null!==Zr&&Zr.apply(this,arguments)||this}function ci(t,e,n){void 0===e?e=0:e>t.length&&Ur(),void 0===n?n=t.length-e:n>t.length-e&&Ur(),this.segments=t,this.offset=e,this.len=n}ii.EMPTY_BYTE_STRING=new ii("");var hi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(qr(!!t),"string"!=typeof t)return{seconds:fi(t.seconds),nanos:fi(t.nanos)};var e=0,n=hi.exec(t);qr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function fi(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pi(t){return"string"==typeof t?ii.fromBase64String(t):ii.fromUint8Array(t)}function di(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function yi(t){t=li(t.mapValue.fields.__local_write_time__.timestampValue);return new Hr(t.seconds,t.nanos)}function gi(t){return null==t}function vi(t){return 0===t&&1/t==-1/0}var mi=(bi.fromPath=function(t){return new bi(ti.fromString(t))},bi.fromName=function(t){return new bi(ti.fromString(t).popFirst(5))},bi.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},bi.prototype.isEqual=function(t){return null!==t&&0===ti.comparator(this.path,t.path)},bi.prototype.toString=function(){return this.path.toString()},bi.comparator=function(t,e){return ti.comparator(t.path,e.path)},bi.isDocumentKey=function(t){return t.length%2==0},bi.fromSegments=function(t){return new bi(new ti(t.slice()))},bi);function bi(t){this.path=t}function wi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?di(t)?4:10:Ur()}function _i(r,i){var t,e,n=wi(r);if(n!==wi(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return yi(r).isEqual(yi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=li(r.timestampValue),t=li(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,pi(r.bytesValue).isEqual(pi(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,fi((e=r).geoPointValue.latitude)===fi(t.geoPointValue.latitude)&&fi(e.geoPointValue.longitude)===fi(t.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return fi(t.integerValue)===fi(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=fi(t.doubleValue),e=fi(e.doubleValue);return t===e?vi(t)===vi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Kr(r.arrayValue.values||[],i.arrayValue.values||[],_i);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Yr(e)!==Yr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!_i(e[t],n[t])))return!1;return!0}();default:return Ur()}}function Ei(t,e){return void 0!==(t.values||[]).find(function(t){return _i(t,e)})}function Ti(t,e){var n,r,i,o=wi(t),s=wi(e);if(o!==s)return Gr(o,s);switch(o){case 0:return 0;case 1:return Gr(t.booleanValue,e.booleanValue);case 2:return r=e,i=fi(t.integerValue||t.doubleValue),r=fi(r.integerValue||r.doubleValue),i<r?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Ii(t.timestampValue,e.timestampValue);case 4:return Ii(yi(t),yi(e));case 5:return Gr(t.stringValue,e.stringValue);case 6:return function(t,e){t=pi(t),e=pi(e);return t.compareTo(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Gr(n[i],r[i]);if(0!==o)return o}return Gr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Gr(fi(n.latitude),fi(i.latitude)))?r:Gr(fi(n.longitude),fi(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ti(n[i],r[i]);if(o)return o}return Gr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Gr(r[s],o[s]);if(0!==a)return a;a=Ti(n[r[s]],i[o[s]]);if(0!==a)return a}return Gr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ur()}}function Ii(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Gr(t,e);var n=li(t),t=li(e),e=Gr(n.seconds,t.seconds);return 0!==e?e:Gr(n.nanos,t.nanos)}function Si(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=li(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?pi(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,mi.fromName(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Ur();var e}(t)}function Ai(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ni(t){return t&&"integerValue"in t}function Di(t){return!!t&&"arrayValue"in t}function Ci(t){return t&&"nullValue"in t}function Ri(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ki(t){return t&&"mapValue"in t}var Oi=(Li.empty=function(){return new Li({mapValue:{}})},Li.prototype.field=function(t){return Li.extractNestedValue(this.buildProto(),t)},Li.prototype.toProto=function(){return this.field(ni.emptyPath())},Li.prototype.set=function(t,e){this.setOverlay(t,e)},Li.prototype.setAll=function(t){var n=this;t.forEach(function(t,e){t?n.set(e,t):n.delete(e)})},Li.prototype.delete=function(t){this.setOverlay(t,null)},Li.prototype.isEqual=function(t){return _i(this.buildProto(),t.buildProto())},Li.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===wi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.lastSegment(),e)},Li.prototype.applyOverlay=function(r,t){var i=this,o=!1,e=Li.extractNestedValue(this.partialValue,r),s=ki(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.applyOverlay(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Li.prototype.buildProto=function(){var t=this.applyOverlay(ni.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},Li.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!ki(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},Li.prototype.clone=function(){return new Li(this.buildProto())},Li);function Li(t){this.overlayMap=new Map,this.partialValue=t}var Pi=(xi.newInvalidDocument=function(t){return new xi(t,0,Wr.min(),Oi.empty(),0)},xi.newFoundDocument=function(t,e,n){return new xi(t,1,e,n,0)},xi.newNoDocument=function(t,e){return new xi(t,2,e,Oi.empty(),0)},xi.newUnknownDocument=function(t,e){return new xi(t,3,e,Oi.empty(),2)},xi.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},xi.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Oi.empty(),this.documentState=0,this},xi.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Oi.empty(),this.documentState=2,this},xi.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},xi.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(xi.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(xi.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),xi.prototype.isValidDocument=function(){return 0!==this.documentType},xi.prototype.isFoundDocument=function(){return 1===this.documentType},xi.prototype.isNoDocument=function(){return 2===this.documentType},xi.prototype.isUnknownDocument=function(){return 3===this.documentType},xi.prototype.isEqual=function(t){return t instanceof xi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},xi.prototype.clone=function(){return new xi(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},xi.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},xi),Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function xi(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}function Fi(t,e,n,r,i,o,s){return new Mi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function Vi(t){var e=t;return null===e.h&&(t=e.path.canonicalString(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.canonicalString()+t.op.toString()+Si(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.canonicalString()+t.dir}).join(","),gi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=po(e.startAt)),e.endAt&&(t+="|ub:",t+=po(e.endAt)),e.h=t),e.h}function Ui(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!_i(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vo(t.startAt,e.startAt)&&vo(t.endAt,e.endAt)}function qi(t){return mi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Bi,ji=(n(Gi,Bi=function(){}),Gi.create=function(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,n):new Qi(t,e,n):"array-contains"===e?new io(t,n):"in"===e?new oo(t,n):"not-in"===e?new so(t,n):"array-contains-any"===e?new ao(t,n):new Gi(t,e,n)},Gi.l=function(t,e,n){return new("in"===e?zi:Yi)(t,n)},Gi.prototype.matches=function(t){t=t.data.field(this.field);return"!="===this.op?null!==t&&this.m(Ti(t,this.value)):null!==t&&wi(this.value)===wi(t)&&this.m(Ti(t,this.value))},Gi.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ur()}},Gi.prototype.g=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Gi);function Gi(t,e,n){var r=this;return(r=Bi.call(this)||this).field=t,r.op=e,r.value=n,r}var Ki,Hi,Wi,Qi=(n($i,Wi=ji),$i.prototype.matches=function(t){t=mi.comparator(t.key,this.key);return this.m(t)},$i),zi=(n(Ji,Hi=ji),Ji.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Ji),Yi=(n(Xi,Ki=ji),Xi.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Xi);function Xi(t,e){var n=this;return(n=Ki.call(this,t,"not-in",e)||this).keys=Zi(0,e),n}function Ji(t,e){var n=this;return(n=Hi.call(this,t,"in",e)||this).keys=Zi(0,e),n}function $i(t,e,n){var r=this;return(r=Wi.call(this,t,e,n)||this).key=mi.fromName(n.referenceValue),r}function Zi(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return mi.fromName(t.referenceValue)})}var to,eo,no,ro,io=(n(fo,ro=ji),fo.prototype.matches=function(t){t=t.data.field(this.field);return Di(t)&&Ei(t.arrayValue,this.value)},fo),oo=(n(lo,no=ji),lo.prototype.matches=function(t){t=t.data.field(this.field);return null!==t&&Ei(this.value.arrayValue,t)},lo),so=(n(ho,eo=ji),ho.prototype.matches=function(t){if(Ei(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.data.field(this.field);return null!==t&&!Ei(this.value.arrayValue,t)},ho),ao=(n(co,to=ji),co.prototype.matches=function(t){var e=this,t=t.data.field(this.field);return!(!Di(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Ei(e.value.arrayValue,t)})},co),uo=function(t,e){this.position=t,this.before=e};function co(t,e){return to.call(this,t,"array-contains-any",e)||this}function ho(t,e){return eo.call(this,t,"not-in",e)||this}function lo(t,e){return no.call(this,t,"in",e)||this}function fo(t,e){return ro.call(this,t,"array-contains",e)||this}function po(t){return(t.before?"b":"a")+":"+t.position.map(Si).join(",")}var yo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function go(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.isKeyField()?mi.comparator(mi.fromName(s.referenceValue),n.key):Ti(s,n.data.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function vo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!_i(t.position[n],e.position[n]))return!1;return!0}var mo=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function bo(t){return new mo(t)}function wo(t){return!gi(t.limit)&&"F"===t.limitType}function _o(t){return!gi(t.limit)&&"L"===t.limitType}function Eo(t){return 0<t.explicitOrderBy.length?t.explicitOrderBy[0].field:null}function To(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Io(t){return null!==t.collectionGroup}function So(t){var e=t;if(null===e.p){e.p=[];var n=To(e),t=Eo(e);if(null!==n&&null===t)n.isKeyField()||e.p.push(new yo(n)),e.p.push(new yo(ni.keyField(),"asc"));else{for(var r=!1,i=0,o=e.explicitOrderBy;i<o.length;i++){var s=o[i];e.p.push(s),s.field.isKeyField()&&(r=!0)}r||(n=0<e.explicitOrderBy.length?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",e.p.push(new yo(ni.keyField(),n)))}}return e.p}function Ao(t){var e=t;if(!e.T)if("F"===e.limitType)e.T=Fi(e.path,e.collectionGroup,So(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=So(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new yo(o.field,s))}var a=e.endAt?new uo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new uo(e.startAt.position,!e.startAt.before):null;e.T=Fi(e.path,e.collectionGroup,n,e.filters,e.limit,a,t)}return e.T}function No(t,e,n){return new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Do(t,e){return Ui(Ao(t),Ao(e))&&t.limitType===e.limitType}function Co(t){return Vi(Ao(t))+"|lt:"+t.limitType}function Ro(t){return"Query(target="+(e=Ao(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.canonicalString()+" "+t.op+" "+Si(t.value)}).join(", ")+"]"),gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.canonicalString()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+po(e.startAt)),e.endAt&&(n+=", endAt: "+po(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function ko(i,t){return t.isFoundDocument()&&(e=i,n=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):mi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n))&&function(t){for(var e=0,n=i.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.data.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||go(t.startAt,So(t),n))&&(!t.endAt||!go(t.endAt,So(t),n)));var e,n}function Oo(a){return function(t,e){for(var n=!1,r=0,i=So(a);r<i.length;r++){var o=i[r],s=function(t,r,e){var n=t.field.isKeyField()?mi.comparator(r.key,e.key):function(t,e){var n=r.data.field(t),t=e.data.field(t);return null!==n&&null!==t?Ti(n,t):Ur()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ur()}}(o,t,e);if(0!==s)return s;n=n||o.field.isKeyField()}return 0}}function Lo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Po(t){return{integerValue:""+t}}function Mo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!vi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Po(e):Lo(t,e);var n}T=function(){this._=void 0};function xo(t,e){return t instanceof Yo?Ni(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Fo,Vo,Uo=(n(jo,Vo=T),jo),qo=(n(Bo,Fo=T),Bo);function Bo(t){var e=this;return(e=Fo.call(this)||this).elements=t,e}function jo(){return null!==Vo&&Vo.apply(this,arguments)||this}function Go(t,e){for(var n=$o(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return _i(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ko,Ho=(n(Wo,Ko=T),Wo);function Wo(t){var e=this;return(e=Ko.call(this)||this).elements=t,e}function Qo(t,e){for(var n=$o(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!_i(t,e)})}(i[r]);return{arrayValue:{values:n}}}var zo,Yo=(n(Xo,zo=T),Xo);function Xo(t,e){var n=this;return(n=zo.call(this)||this).R=t,n.A=e,n}function Jo(t){return fi(t.integerValue||t.doubleValue)}function $o(t){return Di(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Zo(t,e){this.field=t,this.transform=e}function ts(t,e){this.version=t,this.transformResults=e}var es=(ns.none=function(){return new ns},ns.exists=function(t){return new ns(void 0,t)},ns.updateTime=function(t){return new ns(t)},Object.defineProperty(ns.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ns.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ns);function ns(t,e){this.updateTime=t,this.exists=e}function rs(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}Se=function(){};function is(t,e,n){var r,i,o,s;t instanceof cs?(i=e,o=n,rs((r=t).precondition,i)&&(s=r.value.clone(),o=ys(r.fieldTransforms,o,i),s.setAll(o),i.convertToFoundDocument(ss(i),s).setHasLocalMutations())):t instanceof hs?(o=e,i=n,rs((s=t).precondition,o)&&(n=ys(s.fieldTransforms,i,o),(i=o.data).setAll(ps(s)),i.setAll(n),o.convertToFoundDocument(ss(o),i).setHasLocalMutations())):(e=e,rs(t.precondition,e)&&e.convertToNoDocument(Wr.min()))}function os(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Kr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof qo&&e instanceof qo||t instanceof Ho&&e instanceof Ho?Kr(t.elements,e.elements,_i):t instanceof Yo&&e instanceof Yo?_i(t.A,e.A):t instanceof Uo&&e instanceof Uo)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function ss(t){return t.isFoundDocument()?t.version:Wr.min()}var as,us,cs=(n(fs,us=Se),fs),hs=(n(ls,as=Se),ls);function ls(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=as.call(this)||this).key=t,o.data=e,o.fieldMask=n,o.precondition=r,o.fieldTransforms=i,o.type=1,o}function fs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=us.call(this)||this).key=t,i.value=e,i.precondition=n,i.fieldTransforms=r,i.type=0,i}function ps(n){var r=new Map;return n.fieldMask.fields.forEach(function(t){var e;t.isEmpty()||(e=n.data.field(t),r.set(t,e))}),r}function ds(t,e,n){var r=new Map;qr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,(o=s,s=a,a=n[i],o instanceof qo?Go(o,s):o instanceof Ho?Qo(o,s):a))}return r}function ys(t,e,n){for(var r,i=new Map,o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=n.data.field(a.field);i.set(a.field,(r=c,a=e,c=void 0,(u=u)instanceof Uo?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):u instanceof qo?Go(u,r):u instanceof Ho?Qo(u,r):(u=xo(c=u,r),r=Jo(u)+Jo(c.A),Ni(u)&&Ni(c.A)?Po(r):Lo(c.R,r))))}return i}function gs(t){this.count=t}var vs,ms,bs,ws=(n(Ts,bs=Se),Ts),_s=(n(Es,ms=Se),Es);function Es(t,e){var n=this;return(n=ms.call(this)||this).key=t,n.precondition=e,n.type=3,n.fieldTransforms=[],n}function Ts(t,e){var n=this;return(n=bs.call(this)||this).key=t,n.precondition=e,n.type=2,n.fieldTransforms=[],n}function Is(t){switch(t){case Rr.OK:return Ur(),0;case Rr.CANCELLED:case Rr.UNKNOWN:case Rr.DEADLINE_EXCEEDED:case Rr.RESOURCE_EXHAUSTED:case Rr.INTERNAL:case Rr.UNAVAILABLE:case Rr.UNAUTHENTICATED:return;case Rr.INVALID_ARGUMENT:case Rr.NOT_FOUND:case Rr.ALREADY_EXISTS:case Rr.PERMISSION_DENIED:case Rr.FAILED_PRECONDITION:case Rr.ABORTED:case Rr.OUT_OF_RANGE:case Rr.UNIMPLEMENTED:case Rr.DATA_LOSS:return 1;default:return Ur(),0}}function Ss(t){if(void 0===t)return xr("GRPC error has no .code"),Rr.UNKNOWN;switch(t){case vs.OK:return Rr.OK;case vs.CANCELLED:return Rr.CANCELLED;case vs.UNKNOWN:return Rr.UNKNOWN;case vs.DEADLINE_EXCEEDED:return Rr.DEADLINE_EXCEEDED;case vs.RESOURCE_EXHAUSTED:return Rr.RESOURCE_EXHAUSTED;case vs.INTERNAL:return Rr.INTERNAL;case vs.UNAVAILABLE:return Rr.UNAVAILABLE;case vs.UNAUTHENTICATED:return Rr.UNAUTHENTICATED;case vs.INVALID_ARGUMENT:return Rr.INVALID_ARGUMENT;case vs.NOT_FOUND:return Rr.NOT_FOUND;case vs.ALREADY_EXISTS:return Rr.ALREADY_EXISTS;case vs.PERMISSION_DENIED:return Rr.PERMISSION_DENIED;case vs.FAILED_PRECONDITION:return Rr.FAILED_PRECONDITION;case vs.ABORTED:return Rr.ABORTED;case vs.OUT_OF_RANGE:return Rr.OUT_OF_RANGE;case vs.UNIMPLEMENTED:return Rr.UNIMPLEMENTED;case vs.DATA_LOSS:return Rr.DATA_LOSS;default:return Ur()}}(T=vs=vs||{})[T.OK=0]="OK",T[T.CANCELLED=1]="CANCELLED",T[T.UNKNOWN=2]="UNKNOWN",T[T.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",T[T.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",T[T.NOT_FOUND=5]="NOT_FOUND",T[T.ALREADY_EXISTS=6]="ALREADY_EXISTS",T[T.PERMISSION_DENIED=7]="PERMISSION_DENIED",T[T.UNAUTHENTICATED=16]="UNAUTHENTICATED",T[T.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",T[T.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",T[T.ABORTED=10]="ABORTED",T[T.OUT_OF_RANGE=11]="OUT_OF_RANGE",T[T.UNIMPLEMENTED=12]="UNIMPLEMENTED",T[T.INTERNAL=13]="INTERNAL",T[T.UNAVAILABLE=14]="UNAVAILABLE",T[T.DATA_LOSS=15]="DATA_LOSS";var As=(ks.prototype.insert=function(t,e){return new ks(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Ds.BLACK,null,null))},ks.prototype.remove=function(t){return new ks(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ds.BLACK,null,null))},ks.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ks.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ks.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(ks.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ks.prototype.minKey=function(){return this.root.minKey()},ks.prototype.maxKey=function(){return this.root.maxKey()},ks.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},ks.prototype.forEach=function(n){this.inorderTraversal(function(t,e){return n(t,e),!1})},ks.prototype.toString=function(){var n=[];return this.inorderTraversal(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ks.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},ks.prototype.getIterator=function(){return new Ns(this.root,null,this.comparator,!1)},ks.prototype.getIteratorFrom=function(t){return new Ns(this.root,t,this.comparator,!1)},ks.prototype.getReverseIterator=function(){return new Ns(this.root,null,this.comparator,!0)},ks.prototype.getReverseIteratorFrom=function(t){return new Ns(this.root,t,this.comparator,!0)},ks),Ns=(Rs.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},Rs.prototype.hasNext=function(){return 0<this.nodeStack.length},Rs.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},Rs),Ds=(Cs.prototype.copy=function(t,e,n,r,i){return new Cs(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Cs.prototype.isEmpty=function(){return!1},Cs.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},Cs.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},Cs.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},Cs.prototype.minKey=function(){return this.min().key},Cs.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Cs.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},Cs.prototype.removeMin=function(){if(this.left.isEmpty())return Cs.EMPTY;var t=this;return(t=(t=!t.left.isRed()&&!t.left.left.isRed()?t.moveRedLeft():t).copy(null,null,null,t.left.removeMin(),null)).fixUp()},Cs.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=!(r.left.isEmpty()||r.left.isRed()||r.left.left.isRed())?r.moveRedLeft():r).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=!((r=r.left.isRed()?r.rotateRight():r).right.isEmpty()||r.right.isRed()||r.right.left.isRed())?r.moveRedRight():r).key)){if(r.right.isEmpty())return Cs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()},Cs.prototype.isRed=function(){return this.color},Cs.prototype.fixUp=function(){var t=this;return t=(t=(t=t.right.isRed()&&!t.left.isRed()?t.rotateLeft():t).left.isRed()&&t.left.left.isRed()?t.rotateRight():t).left.isRed()&&t.right.isRed()?t.colorFlip():t},Cs.prototype.moveRedLeft=function(){var t=this.colorFlip();return t=t.right.left.isRed()?(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip():t},Cs.prototype.moveRedRight=function(){var t=this.colorFlip();return t=t.left.left.isRed()?(t=t.rotateRight()).colorFlip():t},Cs.prototype.rotateLeft=function(){var t=this.copy(null,null,Cs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Cs.prototype.rotateRight=function(){var t=this.copy(null,null,Cs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Cs.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Cs.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},Cs.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Ur();if(this.right.isRed())throw Ur();var t=this.left.check();if(t!==this.right.check())throw Ur();return t+(this.isRed()?0:1)},Cs);function Cs(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Cs.RED,this.left=null!=r?r:Cs.EMPTY,this.right=null!=i?i:Cs.EMPTY,this.size=this.left.size+1+this.right.size}function Rs(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}function ks(t,e){this.comparator=t,this.root=e||Ds.EMPTY}function Os(){this.size=0}Ds.EMPTY=null,Ds.RED=!0,Ds.BLACK=!1,Ds.EMPTY=(Object.defineProperty(Os.prototype,"key",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(Os.prototype,"value",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(Os.prototype,"color",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(Os.prototype,"left",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(Os.prototype,"right",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Os.prototype.copy=function(t,e,n,r,i){return this},Os.prototype.insert=function(t,e,n){return new Ds(t,e)},Os.prototype.remove=function(t,e){return this},Os.prototype.isEmpty=function(){return!0},Os.prototype.inorderTraversal=function(t){return!1},Os.prototype.reverseTraversal=function(t){return!1},Os.prototype.minKey=function(){return null},Os.prototype.maxKey=function(){return null},Os.prototype.isRed=function(){return!1},Os.prototype.checkMaxDepth=function(){return!0},Os.prototype.check=function(){return 0},new Os);var Ls=(Fs.prototype.has=function(t){return null!==this.data.get(t)},Fs.prototype.first=function(){return this.data.minKey()},Fs.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(Fs.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Fs.prototype.indexOf=function(t){return this.data.indexOf(t)},Fs.prototype.forEach=function(n){this.data.inorderTraversal(function(t,e){return n(t),!1})},Fs.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},Fs.prototype.forEachWhile=function(t,e){for(var n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},Fs.prototype.firstAfterOrEqual=function(t){t=this.data.getIteratorFrom(t);return t.hasNext()?t.getNext().key:null},Fs.prototype.getIterator=function(){return new Ps(this.data.getIterator())},Fs.prototype.getIteratorFrom=function(t){return new Ps(this.data.getIteratorFrom(t))},Fs.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},Fs.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Fs.prototype.isEmpty=function(){return this.data.isEmpty()},Fs.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Fs.prototype.isEqual=function(t){if(!(t instanceof Fs))return!1;if(this.size!==t.size)return!1;for(var e=this.data.getIterator(),n=t.data.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},Fs.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Fs.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Fs.prototype.copy=function(t){var e=new Fs(this.comparator);return e.data=t,e},Fs),Ps=(xs.prototype.getNext=function(){return this.iter.getNext().key},xs.prototype.hasNext=function(){return this.iter.hasNext()},xs),Ms=new As(mi.comparator);function xs(t){this.iter=t}function Fs(t){this.comparator=t,this.data=new As(this.comparator)}var Vs=new As(mi.comparator);var Us=new As(mi.comparator);var qs=new Ls(mi.comparator);function Bs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=qs,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var js=new Ls(Gr);var Gs=(Zs.createSynthesizedRemoteEventForCurrentChange=function(t,e){var n=new Map;return n.set(t,Ks.createSynthesizedTargetChangeForCurrentChange(t,e)),new Zs(Wr.min(),n,js,Ms,Bs())},Zs),Ks=($s.createSynthesizedTargetChangeForCurrentChange=function(t,e){return new $s(ii.EMPTY_BYTE_STRING,e,Bs(),Bs(),Bs())},$s),Hs=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Ws=function(t,e){this.targetId=t,this.V=e},Qs=function(t,e,n,r){void 0===n&&(n=ii.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},zs=(Object.defineProperty(Js.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(Js.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(Js.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(Js.prototype,"$",{get:function(){return this.F},enumerable:!1,configurable:!0}),Js.prototype.O=function(t){0<t.approximateByteSize()&&(this.F=!0,this.C=t)},Js.prototype.M=function(){var n=Bs(),r=Bs(),i=Bs();return this.D.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ur()}}),new Ks(this.C,this.N,n,r,i)},Js.prototype.L=function(){this.F=!1,this.D=ea()},Js.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},Js.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},Js.prototype.U=function(){this.S+=1},Js.prototype.K=function(){--this.S},Js.prototype.j=function(){this.F=!0,this.N=!0},Js),Ys=(Xs.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},Xs.prototype.et=function(n){var r=this;this.forEachTarget(n,function(t){var e=r.nt(t);switch(n.state){case 0:r.st(t)&&e.O(n.resumeToken);break;case 1:e.K(),e.k||e.L(),e.O(n.resumeToken);break;case 2:e.K(),e.k||r.removeTarget(t);break;case 3:r.st(t)&&(e.j(),e.O(n.resumeToken));break;case 4:r.st(t)&&(r.it(t),e.O(n.resumeToken));break;default:Ur()}})},Xs.prototype.forEachTarget=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.G.forEach(function(t,e){r.st(e)&&n(e)})},Xs.prototype.rt=function(t){var e=t.targetId,n=t.V.count,t=this.ot(e);t&&(qi(t=t.target)?0===n?(t=new mi(t.path),this.tt(e,t,Pi.newNoDocument(t,Wr.min()))):qr(1===n):this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e)))},Xs.prototype.ut=function(r){var i=this,o=new Map;this.G.forEach(function(t,e){var n=i.ot(e);n&&(t.current&&qi(n.target)&&(n=new mi(n.target.path),null!==i.H.get(n)||i.at(e,n)||i.tt(e,n,Pi.newNoDocument(n,r))),t.$&&(o.set(e,t.M()),t.L()))});var s=Bs();this.J.forEach(function(t,e){var n=!0;e.forEachWhile(function(t){t=i.ot(t);return!t||2===t.purpose||(n=!1)}),n&&(s=s.add(t))});var t=new Gs(r,o,this.Y,this.H,s);return this.H=Ms,this.J=ta(),this.Y=new Ls(Gr),t},Xs.prototype.Z=function(t,e){var n;this.st(t)&&(n=this.at(t,e.key)?2:0,this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t)))},Xs.prototype.tt=function(t,e,n){var r;this.st(t)&&(r=this.nt(t),this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n)))},Xs.prototype.removeTarget=function(t){this.G.delete(t)},Xs.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},Xs.prototype.U=function(t){this.nt(t).U()},Xs.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new zs,this.G.set(t,e)),e},Xs.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Ls(Gr),this.J=this.J.insert(t,e)),e},Xs.prototype.st=function(t){var e=null!==this.ot(t);return e||Mr("WatchChangeAggregator","Detected inactive target",t),e},Xs.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},Xs.prototype.it=function(e){var n=this;this.G.set(e,new zs),this.W.getRemoteKeysForTarget(e).forEach(function(t){n.tt(e,t,null)})},Xs.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},Xs);function Xs(t){this.W=t,this.G=new Map,this.H=Ms,this.J=ta(),this.Y=new Ls(Gr)}function Js(){this.S=0,this.D=ea(),this.C=ii.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}function $s(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}function Zs(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}function ta(){return new As(mi.comparator)}function ea(){return new As(mi.comparator)}var na={asc:"ASCENDING",desc:"DESCENDING"},ra={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ia=function(t,e){this.databaseId=t,this.I=e};function oa(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function sa(t,e){return t.I?e.toBase64():e.toUint8Array()}function aa(t){return qr(!!t),Wr.fromTimestamp((t=li(t),new Hr(t.seconds,t.nanos)))}function ua(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).canonicalString()}function ca(t){t=ti.fromString(t);return qr(Sa(t)),t}function ha(t,e){return ua(t.databaseId,e.path)}function la(t,e){e=ca(e);if(e.get(1)!==t.databaseId.projectId)throw new kr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.databaseId.projectId);if(e.get(3)!==t.databaseId.database)throw new kr(Rr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.databaseId.database);return new mi(da(e))}function fa(t,e){return ua(t.databaseId,e)}function pa(t){return new ti(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function da(t){return qr(4<t.length&&"documents"===t.get(4)),t.popFirst(5)}function ya(t,e,n){return{name:ha(t,e),fields:n.toProto().mapValue.fields}}function ga(t,e){var n,r,i;if(e instanceof cs)n={update:ya(t,e.key,e.value)};else if(e instanceof ws)n={delete:ha(t,e.key)};else if(e instanceof hs)n={update:ya(t,e.key,e.data),updateMask:(i=e.fieldMask,r=[],i.fields.forEach(function(t){return r.push(t.canonicalString())}),{fieldPaths:r})};else{if(!(e instanceof _s))return Ur();n={verify:ha(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Uo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(e instanceof qo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:e.elements}};if(e instanceof Ho)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:e.elements}};if(e instanceof Yo)return{fieldPath:t.field.canonicalString(),increment:e.A};throw Ur()})),e.precondition.isNone||(n.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:(e=t,t=i.updateTime,oa(e,t.toTimestamp()))}:void 0!==i.exists?{exists:i.exists}:Ur()),n}function va(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=fa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=fa(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Ri(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NAN"}};if(Ci(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ri(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NOT_NAN"}};if(Ci(t.value))return{unaryFilter:{field:_a(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:_a(t.field),op:(e=t.op,ra[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:_a((t=t).field),direction:(t=t.dir,na[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.I||gi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ba(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ba(e.endAt)),n}function ma(t){var e=4===(o=ca(t.parent)).length?ti.emptyPath():da(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(qr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[Ia(t)]:void 0!==t.fieldFilter?[Ta(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Ur():[]}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new yo(Ea((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=gi(a="object"==typeof(a=n.limit)?a.value:a)?null:a);var s=null;n.startAt&&(s=wa(n.startAt));var a=null;return n.endAt&&(a=wa(n.endAt)),new mo(e,i,t,o,r,"F",s,a)}function ba(t){return{before:t.before,values:t.position}}function wa(t){var e=!!t.before,t=t.values||[];return new uo(t,e)}function _a(t){return{fieldPath:t.canonicalString()}}function Ea(t){return ni.fromServerFormat(t.fieldPath)}function Ta(t){return ji.create(Ea(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ur()}}(),t.fieldFilter.value)}function Ia(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ea(t.unaryFilter.field);return ji.create(e,"==",{doubleValue:NaN});case"IS_NULL":e=Ea(t.unaryFilter.field);return ji.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=Ea(t.unaryFilter.field);return ji.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=Ea(t.unaryFilter.field);return ji.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ur()}}function Sa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Se=(Ca.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},Ca.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},Ca),Aa=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},Na=(Da.prototype.catch=function(t){return this.next(void 0,t)},Da.prototype.next=function(r,i){var o=this;return this.callbackAttached&&Ur(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new Da(function(e,n){o.nextCallback=function(t){o.wrapSuccess(r,t).next(e,n)},o.catchCallback=function(t){o.wrapFailure(i,t).next(e,n)}})},Da.prototype.toPromise=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Da.prototype.wrapUserFunction=function(t){try{var e=t();return e instanceof Da?e:Da.resolve(e)}catch(t){return Da.reject(t)}},Da.prototype.wrapSuccess=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Da.resolve(e)},Da.prototype.wrapFailure=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Da.reject(e)},Da.resolve=function(n){return new Da(function(t,e){t(n)})},Da.reject=function(n){return new Da(function(t,e){e(n)})},Da.waitFor=function(t){return new Da(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Da.or=function(t){for(var n=Da.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Da.resolve(t):e()})}(r[e]);return n},Da.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.waitFor(i)},Da);function Da(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}function Ca(){this.onCommittedListeners=[]}function Ra(t){return"IndexedDbTransactionError"===t.name}function ka(t){this.Lt=t}var Oa=(Fa.prototype.applyToRemoteDocument=function(t,e){for(var n,r,i,o,s,a,u=e.mutationResults,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t.key)&&(n=h,r=t,i=u[c],h=a=s=o=void 0,n instanceof cs?(s=r,a=i,h=(o=n).value.clone(),o=ds(o.fieldTransforms,s,a.transformResults),h.setAll(o),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()):n instanceof hs?(o=r,s=i,rs((a=n).precondition,o)?(h=ds(a.fieldTransforms,o,s.transformResults),(n=o.data).setAll(ps(a)),n.setAll(h),o.convertToFoundDocument(s.version,n).setHasCommittedMutations()):o.convertToUnknownDocument(s.version)):r.convertToNoDocument(i.version).setHasCommittedMutations())}},Fa.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(r=n[e]).key.isEqual(t.key)&&is(r,t,this.localWriteTime);for(var r,i=0,o=this.mutations;i<o.length;i++)(r=o[i]).key.isEqual(t.key)&&is(r,t,this.localWriteTime)},Fa.prototype.applyToLocalDocumentSet=function(n){var r=this;this.mutations.forEach(function(t){var e=n.get(t.key),t=e;r.applyToLocalView(t),e.isValidDocument()||t.convertToNoDocument(Wr.min())})},Fa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Bs())},Fa.prototype.isEqual=function(t){return this.batchId===t.batchId&&Kr(this.mutations,t.mutations,os)&&Kr(this.baseMutations,t.baseMutations,os)},Fa),La=(xa.from=function(t,e,n){qr(t.mutations.length===n.length);for(var r=Us,i=t.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new xa(t,e,n,r)},xa),Pa=(Ma.prototype.withSequenceNumber=function(t){return new Ma(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ma.prototype.withResumeToken=function(t,e){return new Ma(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ma.prototype.withLastLimboFreeSnapshotVersion=function(t){return new Ma(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},Ma);function Ma(t,e,n,r,i,o,s){void 0===i&&(i=Wr.min()),void 0===o&&(o=Wr.min()),void 0===s&&(s=ii.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function xa(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}function Fa(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}function Va(t){var e=ma({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?No(e,e.limit,"L"):e}var Ua=(Ka.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Na.resolve()},Ka.prototype.getCollectionParents=function(t,e){return Na.resolve(this.Bt.getEntries(e))},Ka),qa=(Ga.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Ls(ti.comparator),t=!r.has(n);return this.index[e]=r.add(n),t},Ga.prototype.has=function(t){var e=t.lastSegment(),t=t.popLast(),e=this.index[e];return e&&e.has(t)},Ga.prototype.getEntries=function(t){return(this.index[t]||new Ls(ti.comparator)).toArray()},Ga),Ba=(ja.prototype.next=function(){return this.Ht+=2,this.Ht},ja.Jt=function(){return new ja(0)},ja.Yt=function(){return new ja(-1)},ja);function ja(t){this.Ht=t}function Ga(){this.index={}}function Ka(){this.Bt=new qa}function Ha(e){return y(this,void 0,void 0,function(){return g(this,function(t){if(e.code!==Rr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Mr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Wa(t,e){this.progress=t,this.wn=e}var Qa=(ru.prototype.get=function(t){var e=this.mapKeyFn(t),e=this.inner[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.equalsFn(o,t))return i}},ru.prototype.has=function(t){return void 0!==this.get(t)},ru.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},ru.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},ru.prototype.forEach=function(s){Xr(this.inner,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ru.prototype.isEmpty=function(){return Jr(this.inner)},ru),T=(nu.prototype.getReadTime=function(t){t=this.changes.get(t);return t?t.readTime:Wr.min()},nu.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},nu.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Pi.newInvalidDocument(t),readTime:e})},nu.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Na.resolve(n.document):this.getFromCache(t,e)},nu.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},nu.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},nu.prototype.assertNotApplied=function(){},nu),za=(eu.prototype.mn=function(e,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,n).next(function(t){return r.yn(e,n,t)})},eu.prototype.yn=function(t,e,r){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,n=r;e<n.length;e++)n[e].applyToLocalView(t);return t})},eu.prototype.gn=function(t,i){t.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)r[n].applyToLocalView(e)})},eu.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next(function(t){return n.En(e,t).next(function(){return t})})},eu.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},eu.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,mi.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Tn(t,e.path):Io(e)?this.In(t,e,n):this.An(t,e,n);var r},eu.prototype.Tn=function(t,e){return this.mn(t,new mi(e)).next(function(t){var e=Vs;return e=t.isFoundDocument()?e.insert(t.key,t):e})},eu.prototype.In=function(n,r,i){var o=this,s=r.collectionGroup,a=Vs;return this.Ut.getCollectionParents(n,s).next(function(t){return Na.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new mo(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.An(n,e,i).next(function(t){t.forEach(function(t,e){a=a.insert(t,e)})})}).next(function(){return a})})},eu.prototype.An=function(e,n,t){var c,h,r=this;return this.Ue.getDocumentsMatchingQuery(e,n,t).next(function(t){return c=t,r._n.getAllMutationBatchesAffectingQuery(e,n)}).next(function(t){return h=t,r.Rn(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a);null==u&&(u=Pi.newInvalidDocument(a),c=c.insert(a,u)),is(s,u,r.localWriteTime),u.isFoundDocument()||(c=c.remove(a))}})}).next(function(){return c.forEach(function(t,e){ko(n,e)||(c=c.remove(t))}),c})},eu.prototype.Rn=function(t,e,n){for(var r=Bs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof hs&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},eu),Ya=(tu.Pn=function(t,e){for(var n=Bs(),r=Bs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new tu(t,e.fromCache,n,r)},tu),Xa=(Za.prototype.Vn=function(t){this.Sn=t},Za.prototype.getDocumentsMatchingQuery=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())||i.isEqual(Wr.min())?this.Dn(e,r):this.Sn.pn(e,o).next(function(t){var n=s.Cn(r,t);return(wo(r)||_o(r))&&s.Nn(r.limitType,n,o,i)?s.Dn(e,r):(Pr()<=d.DEBUG&&Mr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ro(r)),s.Sn.getDocumentsMatchingQuery(e,r,i).next(function(e){return n.forEach(function(t){e=e.insert(t.key,t)}),e}))})},Za.prototype.Cn=function(n,t){var r=new Ls(Oo(n));return t.forEach(function(t,e){ko(n,e)&&(r=r.add(e))}),r},Za.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.compareTo(r))},Za.prototype.Dn=function(t,e){return Pr()<=d.DEBUG&&Mr("QueryEngine","Using full collection scan to execute query:",Ro(e)),this.Sn.getDocumentsMatchingQuery(t,e,Wr.min())},Za),Ja=($a.prototype.collectGarbage=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.collect(t,n.Fn)})},$a);function $a(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new As(Gr),this.kn=new Qa(Vi,Ui),this.$n=Wr.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new za(this.On,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}function Za(){}function tu(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}function eu(t,e,n){this.Ue=t,this._n=e,this.Ut=n}function nu(){this.changes=new Qa(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}function ru(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}function iu(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i)._n,m=e.Mn,[4,e.persistence.runTransaction("Handle user change","readonly",function(g){var v;return e._n.getAllMutationBatches(g).next(function(t){return v=t,n=e.persistence.getMutationQueue(o),m=new za(e.On,n,e.persistence.getIndexManager()),n.getAllMutationBatches(g)}).next(function(t){for(var e=[],n=[],r=Bs(),i=0,o=v;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var c=u[a],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.pn(g,r).next(function(t){return{Ln:t,removedBatchIds:e,addedBatchIds:n}})})})];case 1:return r=t.sent(),[2,(e._n=n,e.Mn=m,e.xn.Vn(e.Mn),r)]}})})}function ou(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,a,u=h.batch.keys(),c=l.On.newChangeBuffer({trackRemovals:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),a=Na.resolve(),n.forEach(function(n){a=a.next(function(){return o.getEntry(r,n)}).next(function(t){var e=i.docVersions.get(n);qr(null!==e),t.version.compareTo(e)<0&&(s.applyToRemoteDocument(t,i),t.isValidDocument()&&o.addEntry(t,i.commitVersion))})}),a.next(function(){return e._n.removeMutationBatch(r,s)}).next(function(){return c.apply(t)}).next(function(){return l._n.performConsistencyCheck(t)}).next(function(){return l.Mn.pn(t,u)})})}function su(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function au(t,r){var u=t,c=r.snapshotVersion,h=u.Fn;return u.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=u.On.newChangeBuffer({trackRemovals:!0});h=u.Fn;var a=[];r.targetChanges.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(a.push(u.qe.removeMatchingKeys(s,t.removedDocuments,e).next(function(){return u.qe.addMatchingKeys(s,t.addedDocuments,e)})),0<(i=t.resumeToken).approximateByteSize()&&(n=o.withResumeToken(i,c).withSequenceNumber(s.currentSequenceNumber),h=h.insert(e,n),r=o,i=t,qr(0<(o=n).resumeToken.approximateByteSize()),(0===r.resumeToken.approximateByteSize()||3e8<=o.snapshotVersion.toMicroseconds()-r.snapshotVersion.toMicroseconds()||0<i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size)&&a.push(u.qe.updateTargetData(s,n))))});var e,n=Ms;return r.documentUpdates.forEach(function(t,e){r.resolvedLimboDocuments.has(t)&&a.push(u.persistence.referenceDelegate.updateLimboDocument(s,t))}),a.push(uu(s,t,r.documentUpdates,c,void 0).next(function(t){n=t})),c.isEqual(Wr.min())||(e=u.qe.getLastRemoteSnapshotVersion(s).next(function(t){return u.qe.setTargetsMetadata(s,s.currentSequenceNumber,c)}),a.push(e)),Na.waitFor(a).next(function(){return t.apply(s)}).next(function(){return u.Mn.En(s,n)}).next(function(){return n})}).then(function(t){return u.Fn=h,t})}function uu(t,s,e,a,u){var n=Bs();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=Ms;return e.forEach(function(t,e){var n=i.get(t),r=(null==u?void 0:u.get(t))||a;e.isNoDocument()&&e.version.isEqual(Wr.min())?(s.removeEntry(t,r),o=o.insert(t,e)):!n.isValidDocument()||0<e.version.compareTo(n.version)||0===e.version.compareTo(n.version)&&n.hasPendingWrites?(s.addEntry(e,r),o=o.insert(t,e)):Mr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function cu(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qe.getTargetData(e,r).next(function(t){return t?(n=t,Na.resolve(n)):i.qe.allocateTargetId(e).next(function(t){return n=new Pa(r,t,0,e.currentSequenceNumber),i.qe.addTargetData(e,n).next(function(){return n})})})}).then(function(t){var e=i.Fn.get(t.targetId);return(null===e||0<t.snapshotVersion.compareTo(e.snapshotVersion))&&(i.Fn=i.Fn.insert(t.targetId,t),i.kn.set(r,t.targetId)),t})}function hu(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:n=(e=i).Fn.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.referenceDelegate.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ra(r=t.sent()))throw r;return Mr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Fn=e.Fn.remove(o),e.kn.delete(n.target),[2]}})})}function lu(t,o,s){var a=t,u=Wr.min(),c=Bs();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=Ao(o),(void 0!==(t=(i=t).kn.get(r))?Na.resolve(i.Fn.get(t)):i.qe.getTargetData(n,r)).next(function(t){if(t)return u=t.lastLimboFreeSnapshotVersion,a.qe.getMatchingKeysForTargetId(e,t.targetId).next(function(t){c=t})}).next(function(){return a.xn.getDocumentsMatchingQuery(e,o,s?u:Wr.min(),s?c:Bs())}).next(function(t){return{documents:t,Bn:c}});var t,n,r,i})}var fu,pu,du=(Mu.prototype.getBundleMetadata=function(t,e){return Na.resolve(this.Kn.get(e))},Mu.prototype.saveBundleMetadata=function(t,e){return this.Kn.set(e.id,{id:e.id,version:e.version,createTime:aa(e.createTime)}),Na.resolve()},Mu.prototype.getNamedQuery=function(t,e){return Na.resolve(this.jn.get(e))},Mu.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(e=e).name,query:Va(e.bundledQuery),readTime:aa(e.readTime)}),Na.resolve()},Mu),yu=(Pu.prototype.isEmpty=function(){return this.Wn.isEmpty()},Pu.prototype.addReference=function(t,e){e=new gu(t,e);this.Wn=this.Wn.add(e),this.zn=this.zn.add(e)},Pu.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},Pu.prototype.removeReference=function(t,e){this.Yn(new gu(t,e))},Pu.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},Pu.prototype.Zn=function(t){var e=this,n=new mi(new ti([])),r=new gu(n,t),t=new gu(n,t+1),i=[];return this.zn.forEachInRange([r,t],function(t){e.Yn(t),i.push(t.key)}),i},Pu.prototype.ts=function(){var e=this;this.Wn.forEach(function(t){return e.Yn(t)})},Pu.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},Pu.prototype.es=function(t){var e=new mi(new ti([])),n=new gu(e,t),t=new gu(e,t+1),r=Bs();return this.zn.forEachInRange([n,t],function(t){r=r.add(t.key)}),r},Pu.prototype.containsKey=function(t){var e=new gu(t,0),e=this.Wn.firstAfterOrEqual(e);return null!==e&&t.isEqual(e.key)},Pu),gu=(Lu.Gn=function(t,e){return mi.comparator(t.key,e.key)||Gr(t.ns,e.ns)},Lu.Hn=function(t,e){return Gr(t.ns,e.ns)||mi.comparator(t.key,e.key)},Lu),vu=(Ou.prototype.checkEmpty=function(t){return Na.resolve(0===this._n.length)},Ou.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,0<this._n.length&&this._n[this._n.length-1];n=new Oa(i,e,n,r);this._n.push(n);for(var o=0,s=r;o<s.length;o++){var a=s[o];this.rs=this.rs.add(new gu(a.key,i)),this.Ut.addToCollectionParentIndex(t,a.key.path.popLast())}return Na.resolve(n)},Ou.prototype.lookupMutationBatch=function(t,e){return Na.resolve(this.os(e))},Ou.prototype.getNextMutationBatchAfterBatchId=function(t,e){e+=1,e=this.cs(e),e=e<0?0:e;return Na.resolve(this._n.length>e?this._n[e]:null)},Ou.prototype.getHighestUnacknowledgedBatchId=function(){return Na.resolve(0===this._n.length?-1:this.ss-1)},Ou.prototype.getAllMutationBatches=function(t){return Na.resolve(this._n.slice())},Ou.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new gu(e,0),e=new gu(e,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([r,e],function(t){t=n.os(t.ns);i.push(t)}),Na.resolve(i)},Ou.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Ls(Gr);return e.forEach(function(t){var e=new gu(t,0),t=new gu(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,t],function(t){r=r.add(t.ns)})}),Na.resolve(this.us(r))},Ou.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,e=n;mi.isDocumentKey(e)||(e=e.child(""));var e=new gu(new mi(e),0),i=new Ls(Gr);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(i=i.add(t.ns)),!0)},e),Na.resolve(this.us(i))},Ou.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){t=e.os(t);null!==t&&n.push(t)}),n},Ou.prototype.removeMutationBatch=function(n,r){var i=this;qr(0===this.hs(r.batchId,"removed")),this._n.shift();var o=this.rs;return Na.forEach(r.mutations,function(t){var e=new gu(t.key,r.batchId);return o=o.delete(e),i.referenceDelegate.markPotentiallyOrphaned(n,t.key)}).next(function(){i.rs=o})},Ou.prototype.Gt=function(t){},Ou.prototype.containsKey=function(t,e){var n=new gu(e,0),n=this.rs.firstAfterOrEqual(n);return Na.resolve(e.isEqual(n&&n.key))},Ou.prototype.performConsistencyCheck=function(t){return this._n.length,Na.resolve()},Ou.prototype.hs=function(t,e){return this.cs(t)},Ou.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},Ou.prototype.os=function(t){t=this.cs(t);return t<0||t>=this._n.length?null:this._n[t]},Ou),mu=(ku.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:i,readTime:n}),this.size+=i-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},ku.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},ku.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Na.resolve(n?n.document.clone():Pi.newInvalidDocument(e))},ku.prototype.getEntries=function(t,e){var n=this,r=Ms;return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Pi.newInvalidDocument(t))}),Na.resolve(r)},ku.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Ms,i=new mi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,s=u.document,u=u.readTime;if(!e.path.isPrefixOf(a.path))break;u.compareTo(n)<=0||ko(e,s)&&(r=r.insert(s.key,s.clone()))}return Na.resolve(r)},ku.prototype.fs=function(t,e){return Na.forEach(this.docs,function(t){return e(t)})},ku.prototype.newChangeBuffer=function(t){return new bu(this)},ku.prototype.getSize=function(t){return Na.resolve(this.size)},ku),bu=(n(Ru,pu=T),Ru.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(t,e){e.document.isValidDocument()?i.push(r.Ie.addEntry(n,e.document,r.getReadTime(t))):r.Ie.removeEntry(t)}),Na.waitFor(i)},Ru.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},Ru.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},Ru),wu=(Cu.prototype.forEachTarget=function(t,n){return this.ds.forEach(function(t,e){return n(e)}),Na.resolve()},Cu.prototype.getLastRemoteSnapshotVersion=function(t){return Na.resolve(this.lastRemoteSnapshotVersion)},Cu.prototype.getHighestSequenceNumber=function(t){return Na.resolve(this.ws)},Cu.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Na.resolve(this.highestTargetId)},Cu.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Na.resolve()},Cu.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Ba(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},Cu.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Na.resolve()},Cu.prototype.updateTargetData=function(t,e){return this.te(e),Na.resolve()},Cu.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),--this.targetCount,Na.resolve()},Cu.prototype.removeTargets=function(n,r,i){var o=this,s=0,a=[];return this.ds.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.ds.delete(t),a.push(o.removeMatchingKeysForTargetId(n,e.targetId)),s++)}),Na.waitFor(a).next(function(){return s})},Cu.prototype.getTargetCount=function(t){return Na.resolve(this.targetCount)},Cu.prototype.getTargetData=function(t,e){e=this.ds.get(e)||null;return Na.resolve(e)},Cu.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Na.resolve()},Cu.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Na.waitFor(i)},Cu.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Na.resolve()},Cu.prototype.getMatchingKeysForTargetId=function(t,e){e=this._s.es(e);return Na.resolve(e)},Cu.prototype.containsKey=function(t,e){return Na.resolve(this._s.containsKey(e))},Cu),_u=(Du.prototype.start=function(){return Promise.resolve()},Du.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(Du.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),Du.prototype.setDatabaseDeletedListener=function(){},Du.prototype.setNetworkEnabled=function(){},Du.prototype.getIndexManager=function(){return this.Ut},Du.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new vu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},Du.prototype.getTargetCache=function(){return this.qe},Du.prototype.getRemoteDocumentCache=function(){return this.Ue},Du.prototype.getBundleCache=function(){return this.Qe},Du.prototype.runTransaction=function(t,e,n){var r=this;Mr("MemoryPersistence","Starting transaction:",t);var i=new Eu(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},Du.prototype.Is=function(e,n){return Na.or(Object.values(this.gs).map(function(t){return function(){return t.containsKey(e,n)}}))},Du),Eu=(n(Nu,fu=Se),Nu),Tu=(Au.bs=function(t){return new Au(t)},Object.defineProperty(Au.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Ur()},enumerable:!1,configurable:!0}),Au.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Na.resolve()},Au.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Na.resolve()},Au.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Na.resolve()},Au.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},Au.prototype.Es=function(){this.Rs=new Set},Au.prototype.Ts=function(n){var r=this,i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Na.forEach(this.vs,function(t){var e=mi.fromPath(t);return r.Ps(n,e).next(function(t){t||i.removeEntry(e)})}).next(function(){return r.Rs=null,i.apply(n)})},Au.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},Au.prototype.ps=function(t){return 0},Au.prototype.Ps=function(t,e){var n=this;return Na.or([function(){return Na.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},Au),Iu=(Su.prototype.isAuthenticated=function(){return null!=this.uid},Su.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Su.prototype.isEqual=function(t){return t.uid===this.uid},Su);function Su(t){this.uid=t}function Au(t){this.persistence=t,this.As=new yu,this.Rs=null}function Nu(t){var e=this;return(e=fu.call(this)||this).currentSequenceNumber=t,e}function Du(t,e){var n=this;this.gs={},this.Ne=new Nr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new wu(this),this.Ut=new Ua,this.Ue=(t=this.Ut,new mu(t,function(t){return n.referenceDelegate.ps(t)})),this.R=new ka(e),this.Qe=new du(this.R)}function Cu(t){this.persistence=t,this.ds=new Qa(Vi,Ui),this.lastRemoteSnapshotVersion=Wr.min(),this.highestTargetId=0,this.ws=0,this._s=new yu,this.targetCount=0,this.ys=Ba.Jt()}function Ru(t){var e=this;return(e=pu.call(this)||this).Ie=t,e}function ku(t,e){this.Ut=t,this.ls=e,this.docs=new As(mi.comparator),this.size=0}function Ou(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Ls(gu.Gn)}function Lu(t,e){this.key=t,this.ns=e}function Pu(){this.Wn=new Ls(gu.Gn),this.zn=new Ls(gu.Hn)}function Mu(t){this.R=t,this.Kn=new Map,this.jn=new Map}Iu.UNAUTHENTICATED=new Iu(null),Iu.GOOGLE_CREDENTIALS=new Iu("google-credentials-uid"),Iu.FIRST_PARTY=new Iu("first-party-uid");var xu,Fu=(Xu.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Xu.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Xu.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},Xu),Vu=(Yu.prototype.addPendingMutation=function(t){},Yu.prototype.updateMutationState=function(t,e,n){},Yu.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},Yu.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},Yu.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},Yu.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},Yu.prototype.clearQueryState=function(t){delete this.fi[t]},Yu.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},Yu.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},Yu.prototype.start=function(){return this.li=new Fu,Promise.resolve()},Yu.prototype.handleUserChange=function(t,e,n){},Yu.prototype.setOnlineState=function(t){},Yu.prototype.shutdown=function(){},Yu.prototype.writeSequenceNumber=function(t){},Yu.prototype.notifyBundleLoaded=function(){},Yu),Uu=(zu.prototype.di=function(t){},zu.prototype.shutdown=function(){},zu),qu=(Qu.prototype.di=function(t){this.gi.push(t)},Qu.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},Qu.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},Qu.prototype._i=function(){Mr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},Qu.prototype.yi=function(){Mr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},Qu.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Qu),Bu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ju=(Wu.prototype.Ii=function(t){this.Ai=t},Wu.prototype.Ri=function(t){this.bi=t},Wu.prototype.onMessage=function(t){this.vi=t},Wu.prototype.close=function(){this.Ti()},Wu.prototype.send=function(t){this.Ei(t)},Wu.prototype.Pi=function(){this.Ai()},Wu.prototype.Vi=function(t){this.bi(t)},Wu.prototype.Si=function(t){this.vi(t)},Wu),Gu=(Hu.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);Mr("RestConnection","Sending: ",i,n);t={};return this.Fi(t,r),this.ki(e,i,t,n).then(function(t){return Mr("RestConnection","Received: ",t),t},function(t){throw Fr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Hu.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},Hu.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+Ar,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},Hu.prototype.xi=function(t,e){t=Bu[t];return this.Di+"/v1/"+e+":"+t},n(Ku,xu=Hu),Ku.prototype.ki=function(o,e,s,a){return new Promise(function(n,r){var i=new Sr;i.listenOnce(wr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case br.NO_ERROR:var t=i.getResponseJson();Mr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case br.TIMEOUT:Mr("Connection",'RPC "'+o+'" timed out'),r(new kr(Rr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e=i.getStatus();Mr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Rr).indexOf(e)?e:Rr.UNKNOWN,r(new kr(e,t.message))):r(new kr(Rr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new kr(Rr.UNAVAILABLE,"Connection failed."));break;default:Ur()}}finally{Mr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(a);i.send(e,"POST",t,s,15)})},Ku.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new pr,o=mr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=h().indexOf("Electron/")||(0<=(n=h()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=h().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Mr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),a=!1,u=!1,c=new ju({Ei:function(t){u?Mr("Connection","Not sending because WebChannel is closed:",t):(a||(Mr("Connection","Opening WebChannel transport."),s.open(),a=!0),Mr("Connection","WebChannel sending:",t),s.send(t))},Ti:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Ir.EventType.OPEN,function(){u||Mr("Connection","WebChannel transport opened.")}),t(s,Ir.EventType.CLOSE,function(){u||(u=!0,Mr("Connection","WebChannel transport closed"),c.Vi())}),t(s,Ir.EventType.ERROR,function(t){u||(u=!0,Fr("Connection","WebChannel transport errored:",t),c.Vi(new kr(Rr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Ir.EventType.MESSAGE,function(t){var e,n,r,i;u||(qr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Mr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=vs[r];if(void 0!==t)return Ss(t)}(),i=n.message,void 0===t&&(t=Rr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,c.Vi(new kr(t,i)),s.close()):(Mr("Connection","WebChannel received:",e),c.Si(e)))}),t(o,_r.STAT_EVENT,function(t){t.stat===Er?Mr("Connection","Detected buffering proxy"):t.stat===Tr&&Mr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Pi()},0),c},Ku);function Ku(t){var e=this;return(e=xu.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.autoDetectLongPolling=t.autoDetectLongPolling,e}function Hu(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}function Wu(t){this.Ei=t.Ei,this.Ti=t.Ti}function Qu(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}function zu(){}function Yu(){this.li=new Fu,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}function Xu(){this.activeTargetIds=js}function Ju(){return"undefined"!=typeof document?document:null}function $u(t){return new ia(t,!0)}function Zu(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return y(o,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return Ec(this)?(Mr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).Or.add(4),[4,yc(e)];case 1:return t.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,dc(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new ac(n,r)}var tc,ec,nc,rc=(pc.prototype.reset=function(){this.qi=0},pc.prototype.Ki=function(){this.qi=this.Bi},pc.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);0<i&&Mr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Qi=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},pc.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},pc.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},pc.prototype.Wi=function(){return(Math.random()-.5)*this.qi},pc),T=(fc.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},fc.prototype.er=function(){return 2===this.state},fc.prototype.start=function(){3!==this.state?this.auth():this.nr()},fc.prototype.stop=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},fc.prototype.sr=function(){this.state=0,this.Zi.reset()},fc.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},fc.prototype.cr=function(t){this.ur(),this.stream.send(t)},fc.prototype.rr=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},fc.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},fc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():n&&n.code===Rr.RESOURCE_EXHAUSTED?(xr(n.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):n&&n.code===Rr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(n)];case 1:return t.sent(),[2]}})})},fc.prototype.ar=function(){},fc.prototype.auth=function(){var n=this;this.state=1;var t=this.hr(this.Yi),e=this.Yi;this.Ji.getToken().then(function(t){n.Yi===e&&n.lr(t)},function(e){t(function(){var t=new kr(Rr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.dr(t)})})},fc.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},fc.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return y(t,void 0,void 0,function(){return g(this,function(t){return this.state=0,this.start(),[2]})})})},fc.prototype.dr=function(t){return Mr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},fc.prototype.hr=function(e){var n=this;return function(t){n.Se.enqueueAndForget(function(){return n.Yi===e?t():(Mr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},fc),ic=(n(lc,nc=T),lc.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},lc.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ur(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.I?(qr(void 0===s||"string"==typeof s),ii.fromBase64String(s||"")):(qr(void 0===s||s instanceof Uint8Array),ii.fromUint8Array(s||new Uint8Array))),o=(a=e.targetChange.cause)&&(u=void 0===(c=a).code?Rr.UNKNOWN:Ss(c.code),new kr(u,c.message||"")),s=new Qs(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime;var r=la(t,n.document.name),i=aa(n.document.updateTime),a=new Oi({mapValue:{fields:n.document.fields}}),u=(o=Pi.newFoundDocument(r,i,a),n.targetIds||[]),c=n.removedTargetIds||[];s=new Hs(u,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=la(t,n.document),i=n.readTime?aa(n.readTime):Wr.min(),a=Pi.newNoDocument(r,i),o=n.removedTargetIds||[],s=new Hs([],o,a.key,a);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=la(t,n.document),i=n.removedTargetIds||[],s=new Hs([],i,r,null);else{if(!("filter"in e))return Ur();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new gs(n),i=e.targetId,s=new Ws(i,r)}return s}(this.R,t),t=function(t){if(!("targetChange"in t))return Wr.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?aa(t.readTime):Wr.min()}(t);return this.listener._r(e,t)},lc.prototype.mr=function(t){var e,n,r,i={};i.database=pa(this.R),i.addTarget=(e=this.R,(r=qi(r=(n=t).target)?{documents:{documents:[fa(e,r.path)]}}:{query:va(e,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=sa(e,n.resumeToken):0<n.snapshotVersion.compareTo(Wr.min())&&(r.readTime=oa(e,n.snapshotVersion.toTimestamp())),r);var o,t=(this.R,o=t,null==(t=function(){switch(o.purpose){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ur()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.cr(i)},lc.prototype.yr=function(t){var e={};e.database=pa(this.R),e.removeTarget=t,this.cr(e)},lc),oc=(n(hc,ec=T),Object.defineProperty(hc.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),hc.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,ec.prototype.start.call(this)},hc.prototype.ar=function(){this.gr&&this.Er([])},hc.prototype.wr=function(t){return this.Hi.Oi("Write",t)},hc.prototype.onMessage=function(t){if(qr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(qr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?aa(e.updateTime):aa(n)).isEqual(Wr.min())&&(t=aa(n)),new ts(t,e.transformResults||[]);var e,n})):[]),n=aa(t.commitTime);return this.listener.Tr(n,e)}var n,r;return qr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},hc.prototype.Ar=function(){var t={};t.database=pa(this.R),this.cr(t)},hc.prototype.Er=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ga(e.R,t)})};this.cr(t)},hc),sc=(n(cc,tc=function(){}),cc.prototype.br=function(){if(this.Rr)throw new kr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},cc.prototype.Ni=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.Ni(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Rr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new kr(Rr.UNKNOWN,t.toString())})},cc.prototype.$i=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.$i(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Rr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new kr(Rr.UNKNOWN,t.toString())})},cc.prototype.terminate=function(){this.Rr=!0},cc),ac=(uc.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},uc.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,1<=this.vr&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},uc.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},uc.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},uc.prototype.Cr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(xr(t),this.Vr=!1):Mr("OnlineStateTracker",t)},uc.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},uc);function uc(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}function cc(t,e,n){var r=this;return(r=tc.call(this)||this).credentials=t,r.Hi=e,r.R=n,r.Rr=!1,r}function hc(t,e,n,r,i){var o=this;return(o=ec.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).R=r,o.gr=!1,o}function lc(t,e,n,r,i){var o=this;return(o=nc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).R=r,o}function fc(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new rc(t,e)}function pc(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}function dc(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:if(!Ec(r))return[3,4];e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yc(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function gc(t,e){t.$r.has(e.targetId)||(t.$r.set(e.targetId,e),_c(t)?wc(t):Rc(t).er()&&mc(t,e))}function vc(t,e){var n=t,t=Rc(n);n.$r.delete(e),t.er()&&bc(n,e),0===n.$r.size&&(t.er()?t.ir():Ec(n)&&n.Br.set("Unknown"))}function mc(t,e){t.qr.U(e.targetId),Rc(t).mr(e)}function bc(t,e){t.qr.U(e),Rc(t).yr(e)}function wc(e){e.qr=new Ys({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),Rc(e).start(),e.Br.Sr()}function _c(t){return Ec(t)&&!Rc(t).tr()&&0<t.$r.size}function Ec(t){return 0===t.Or.size}function Tc(t){t.qr=void 0}function Ic(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:if(s.Br.set("Online"),!(a instanceof Qs&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.$r.has(i)?[4,o.remoteSyncer.rejectListen(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.$r.delete(i),o.qr.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Mr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,Sc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof Hs?s.qr.X(a):a instanceof Ws?s.qr.rt(a):s.qr.et(a),u.isEqual(Wr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,su(s.localStore)];case 8:return o=t.sent(),0<=u.compareTo(o)?[4,(i=u,(e=(r=s).qr.ut(i)).targetChanges.forEach(function(t,e){var n;0<t.resumeToken.approximateByteSize()&&((n=r.$r.get(e))&&r.$r.set(e,n.withResumeToken(t.resumeToken,i)))}),e.targetMismatches.forEach(function(t){var e=r.$r.get(t);e&&(r.$r.set(t,e.withResumeToken(ii.EMPTY_BYTE_STRING,e.snapshotVersion)),bc(r,t),e=new Pa(e.target,t,1,e.sequenceNumber),mc(r,e))}),r.remoteSyncer.applyRemoteEvent(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Mr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Sc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Sc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:if(!Ra(r))throw r;return n.Or.add(1),[4,yc(n)];case 1:return t.sent(),n.Br.set("Offline"),i=i||function(){return su(n.localStore)},n.asyncQueue.enqueueRetryable(function(){return y(e,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return Mr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Or.delete(1),[4,dc(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Ac(e,n){return n().catch(function(t){return Sc(e,t,n)})}function Nc(u){return y(this,void 0,void 0,function(){var i,o,s,a;return g(this,function(t){switch(t.label){case 0:o=kc(i=u),s=0<i.kr.length?i.kr[i.kr.length-1].batchId:-1,t.label=1;case 1:if(!(Ec(i)&&i.kr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.localStore,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r._n.getNextMutationBatchAfterBatchId(t,n)}))];case 3:return null===(a=t.sent())?(0===i.kr.length&&o.ir(),[3,7]):(s=a.batchId,function(t,e){t.kr.push(e);t=kc(t);t.er()&&t.pr&&t.Er(e.mutations)}(i,a),[3,6]);case 4:return a=t.sent(),[4,Sc(i,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Dc(i)&&Cc(i),[2]}var e,n,r})})}function Dc(t){return Ec(t)&&!kc(t).tr()&&0<t.kr.length}function Cc(t){kc(t).start()}function Rc(n){var t,e,r,i=this;return n.Ur||(n.Ur=(t=n.datastore,e=n.asyncQueue,r={Ii:function(n){return y(this,void 0,void 0,function(){return g(this,function(t){return n.$r.forEach(function(t,e){mc(n,t)}),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){return Tc(e),_c(e)?(e.Br.Nr(n),wc(e)):e.Br.set("Unknown"),[2]})})}.bind(null,n),_r:Ic.bind(null,n)},t.br(),new ic(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Ur.sr(),_c(n)?wc(n):n.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Ur.stop()];case 2:t.sent(),Tc(n),t.label=3;case 3:return[2]}})})})),n.Ur}function kc(n){var t,e,r,i=this;return n.Qr||(n.Qr=(t=n.datastore,e=n.asyncQueue,r={Ii:function(e){return y(this,void 0,void 0,function(){return g(this,function(t){return kc(e).Ar(),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return n&&kc(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return Is(n=i.code)&&n!==Rr.ABORTED?(e=r.kr.shift(),kc(r).sr(),[4,Ac(r,function(){return r.remoteSyncer.rejectFailedWrite(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Nc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Dc(e)&&Cc(e),[2]}})})}.bind(null,n),Ir:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){for(e=kc(o),n=0,r=o.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]})})}.bind(null,n),Tr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return e=r.kr.shift(),n=La.from(e,i,o),[4,Ac(r,function(){return r.remoteSyncer.applySuccessfulWrite(n)})];case 1:return t.sent(),[4,Nc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.br(),new oc(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Qr.sr(),[4,Nc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qr.stop()];case 3:t.sent(),0<n.kr.length&&(Mr("RemoteStore","Stopping write stream with "+n.kr.length+" pending writes"),n.kr=[]),t.label=4;case 4:return[2]}})})})),n.Qr}var Oc=(Lc.createAndSchedule=function(t,e,n,r,i){i=new Lc(t,e,Date.now()+n,r,i);return i.start(n),i},Lc.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},Lc.prototype.skipDelay=function(){return this.handleDelayElapsed()},Lc.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new kr(Rr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Lc.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},Lc.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},Lc);function Lc(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Aa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}function Pc(t,e){if(xr("AsyncQueue",e+": "+t),Ra(t))return new kr(Rr.UNAVAILABLE,e+": "+t);throw t}function Mc(){this.queries=new Qa(Co,Do),this.onlineState="Unknown",this.Gr=new Set}var xc=(jc.emptySet=function(t){return new jc(t.comparator)},jc.prototype.has=function(t){return null!=this.keyedMap.get(t)},jc.prototype.get=function(t){return this.keyedMap.get(t)},jc.prototype.first=function(){return this.sortedSet.minKey()},jc.prototype.last=function(){return this.sortedSet.maxKey()},jc.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},jc.prototype.indexOf=function(t){t=this.keyedMap.get(t);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(jc.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),jc.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(t,e){return n(t),!1})},jc.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},jc.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},jc.prototype.isEqual=function(t){if(!(t instanceof jc))return!1;if(this.size!==t.size)return!1;for(var e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},jc.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},jc.prototype.copy=function(t,e){var n=new jc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n},jc),Fc=(Bc.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);!n||0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Ur()},Bc.prototype.jr=function(){var n=[];return this.Kr.inorderTraversal(function(t,e){n.push(e)}),n},Bc),Vc=(qc.fromInitialDocuments=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new qc(t,e,xc.emptySet(e),i,n,r,!0,!1)},Object.defineProperty(qc.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),qc.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Do(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},qc),Uc=function(){this.Wr=void 0,this.listeners=[]};function qc(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}function Bc(){this.Kr=new As(mi.comparator)}function jc(n){this.comparator=n?function(t,e){return n(t,e)||mi.comparator(t.key,e.key)}:function(t,e){return mi.comparator(t.key,e.key)},this.keyedMap=Vs,this.sortedSet=new As(this.comparator)}function Gc(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){switch(t.label){case 0:if(e=s,n=a.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Uc),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.onListen(n)];case 2:return o.Wr=t.sent(),[3,4];case 3:return o=t.sent(),o=Pc(o,"Initialization of query '"+Ro(a.query)+"' failed"),[2,void a.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(a),a.zr(e.onlineState),i.Wr&&a.Hr(i.Wr)&&Hc(e),[2]}})})}function Kc(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){return e=s,n=a.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.onUnlisten(n))]:[2]})})}function Hc(t){t.Gr.forEach(function(t){t.next()})}var Wc=(Zc.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Vc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},Zc.prototype.onError=function(t){this.Jr.error(t)},Zc.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},Zc.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},Zc.prototype.Zr=function(t){if(0<t.docChanges.length)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},Zc.prototype.no=function(t){t=Vc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},Zc),Qc=($c.prototype.io=function(){return"metadata"in this.payload},$c),zc=(Jc.prototype.qn=function(t){return la(this.R,t)},Jc.prototype.Un=function(t){return t.metadata.exists?(e=this.R,n=t.document,r=la(e,n.name),e=aa(n.updateTime),n=new Oi({mapValue:{fields:n.fields}}),n=Pi.newFoundDocument(r,e,n)):Pi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime));var e,n,r},Jc.prototype.Qn=aa,Jc),Yc=(Xc.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Xc.prototype.co=function(t){for(var e=new Map,n=new zc(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Bs()).add(s);e.set(c,h)}}return e},Xc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return[4,function(l,f,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,a,u,c,h;return g(this,function(t){switch(t.label){case 0:for(n=l,r=Bs(),i=Ms,o=Us,e=0,s=p;e<s.length;e++)a=s[e],u=f.qn(a.metadata.name),a.document&&(r=r.add(u)),i=i.insert(u,f.Un(a)),o=o.insert(u,f.Qn(a.metadata.readTime));return c=n.On.newChangeBuffer({trackRemovals:!0}),[4,cu(n,Ao(bo(ti.fromString("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return uu(e,c,i,Wr.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.qe.removeMatchingKeysForTargetId(e,h.targetId).next(function(){return n.qe.addMatchingKeys(e,r,h.targetId)}).next(function(){return n.Mn.En(e,t)}).next(function(){return t})})})]}})})}(this.localStore,new zc(this.R),this.documents,this.ro.id)];case 1:e=t.sent(),n=this.co(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Bs()),y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,cu(e,Ao(Va(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=aa(i.readTime);if(0<=n.snapshotVersion.compareTo(e))return r.Qe.saveNamedQuery(t,i);e=n.withResumeToken(ii.EMPTY_BYTE_STRING,e);return r.Fn=r.Fn.insert(e.targetId,e),r.qe.updateTargetData(t,e).next(function(){return r.qe.removeMatchingKeysForTargetId(t,n.targetId)}).next(function(){return r.qe.addMatchingKeys(t,o,n.targetId)}).next(function(){return r.Qe.saveNamedQuery(t,i)})})]}})})}(this.localStore,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Wa(Object.assign({},this.progress),e))]}})})},Xc);function Xc(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=th(t)}function Jc(t){this.R=t}function $c(t,e){this.payload=t,this.byteLength=e}function Zc(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}function th(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var eh=function(t){this.key=t},nh=function(t){this.key=t},rh=(Object.defineProperty(uh.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),uh.prototype._o=function(t,e){var s=this,a=e?e.mo:new Fc,u=(e||this).fo,c=(e||this).mutatedKeys,h=u,l=!1,f=wo(this.query)&&u.size===this.query.limit?u.last():null,p=_o(this.query)&&u.size===this.query.limit?u.first():null;if(t.inorderTraversal(function(t,e){var n=u.get(t),r=ko(s.query,e)?e:null,i=!!n&&s.mutatedKeys.has(n.key),o=!!r&&(r.hasLocalMutations||s.mutatedKeys.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data.isEqual(r.data)?i!==o&&(a.track({type:3,doc:r}),e=!0):s.yo(n,r)||(a.track({type:2,doc:r}),e=!0,(f&&0<s.lo(r,f)||p&&s.lo(r,p)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),e=!0):n&&!r&&(a.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),wo(this.query)||_o(this.query))for(;h.size>this.query.limit;){var n=wo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{fo:h,mo:a,Nn:l,mutatedKeys:c}},uh.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},uh.prototype.applyChanges=function(t,e,n){var o=this,r=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var i=t.mo.jr();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.lo(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ur()}}var r,i}),this.po(n);var s=e?this.Eo():[],n=0===this.ho.size&&this.current?1:0,e=n!==this.ao;return this.ao=n,0!==i.length||e?{snapshot:new Vc(this.query,t.fo,r,i,t.mutatedKeys,0==n,e,!1),To:s}:{To:s}},uh.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Fc,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},uh.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},uh.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},uh.prototype.Eo=function(){var e=this;if(!this.current)return[];var n=this.ho;this.ho=Bs(),this.fo.forEach(function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))});var r=[];return n.forEach(function(t){e.ho.has(t)||r.push(new nh(t))}),this.ho.forEach(function(t){n.has(t)||r.push(new eh(t))}),r},uh.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Bs();t=this._o(t.documents);return this.applyChanges(t,!0)},uh.prototype.Ro=function(){return Vc.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},uh),ih=function(t,e,n){this.query=t,this.targetId=e,this.view=n},oh=function(t){this.key=t,this.bo=!1},sh=(Object.defineProperty(ah.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),ah);function ah(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Qa(Co,Do),this.Vo=new Map,this.So=new Set,this.Do=new As(mi.comparator),this.Co=new Map,this.No=new yu,this.xo={},this.Fo=new Map,this.ko=Ba.Yt(),this.onlineState="Unknown",this.$o=void 0}function uh(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Bs(),this.mutatedKeys=Bs(),this.lo=Oo(t),this.fo=new xc(this.lo)}function ch(a,u){return y(this,void 0,void 0,function(){var n,r,i,o,s;return g(this,function(t){switch(t.label){case 0:return(e=a).remoteStore.remoteSyncer.applyRemoteEvent=lh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(t,e){var n=t,t=n.Co.get(e);if(t&&t.bo)return Bs().add(t.key);var r=Bs(),e=n.Vo.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Po.get(s);r=r.unionWith(s.view.wo)}return r}.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=function(o,s,a){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return(e=o).sharedClientState.updateQueryState(s,"rejected",a),i=e.Co.get(s),(n=i&&i.key)?(r=(r=new As(mi.comparator)).insert(n,Pi.newNoDocument(n,Wr.min())),i=Bs().add(n),i=new Gs(Wr.min(),new Map,new Ls(Gr),r,i),[4,lh(e,i)]):[3,2];case 1:return t.sent(),e.Do=e.Do.remove(n),e.Co.delete(s),bh(e),[3,4];case 2:return[4,hu(e.localStore,s,!1).then(function(){return gh(e,s,a)}).catch(Ha)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vo._r=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,a=n.queries.get(a);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&Hc(n)}.bind(null,e.eventManager),e.vo.Mo=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.eventManager),(s=(n=e).Po.get(u))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro(),[3,4]):[3,1];case 1:return[4,cu(n.localStore,Ao(u))];case 2:return o=t.sent(),s=n.sharedClientState.addLocalQueryTarget(o.targetId),r=o.targetId,[4,function(i,o,s,a){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return i.Oo=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=i.view._o(o)).Nn?[4,lu(r.localStore,i.query,!1).then(function(t){t=t.documents;return i.view._o(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.targetChanges.get(i.targetId),n=i.view.applyChanges(e,r.isPrimaryClient,n),[2,(mh(r,i.targetId,n.To),n.snapshot)]}})})}(i,t,e,n)},[4,lu(i.localStore,o,!0)];case 1:return n=t.sent(),r=new rh(o,n.Bn),e=r._o(n.documents),n=Ks.createSynthesizedTargetChangeForCurrentChange(s,a&&"Offline"!==i.onlineState),n=r.applyChanges(e,i.isPrimaryClient,n),mh(i,s,n.To),r=new ih(o,s,r),[2,(i.Po.set(o,r),i.Vo.has(s)?i.Vo.get(s).push(o):i.Vo.set(s,[o]),n.snapshot)]}})})}(n,u,r,"current"===s)];case 3:i=t.sent(),n.isPrimaryClient&&gc(n.remoteStore,o),t.label=4;case 4:return[2,i]}var e})})}function hh(f,p,d){return y(this,void 0,void 0,function(){var s,l;return g(this,function(t){switch(t.label){case 0:(o=f).remoteStore.remoteSyncer.applySuccessfulWrite=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,ou(e.localStore,o)];case 2:return r=t.sent(),yh(e,n,null),dh(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),[4,wh(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.remoteStore.remoteSyncer.rejectFailedWrite=function(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.localStore,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i._n.lookupMutationBatch(e,r).next(function(t){return qr(null!==t),n=t.keys(),i._n.removeMutationBatch(e,t)}).next(function(){return i._n.performConsistencyCheck(e)}).next(function(){return i.Mn.pn(e,n)})}))];case 2:return o=t.sent(),yh(n,a,u),dh(n,a),n.sharedClientState.updateMutationState(a,"rejected",u),[4,wh(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),l=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=l.localStore,a=p,c=r,h=Hr.now(),i=a.reduce(function(t,e){return t.add(e.key)},Bs()),c.persistence.runTransaction("Locally write mutations","readwrite",function(s){return c.Mn.pn(s,i).next(function(t){u=t;for(var e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),s=xo(o.transform,s||null);null!=s&&(n=null==n?Oi.empty():n).set(o.field,s)}return n||null}(i,u.get(i.key));null!=o&&e.push(new hs(i.key,o,function s(t){var a=[];return Xr(t.fields||{},function(t,e){var n=new ni([t]);if(ki(e))if(0===(e=s(e.mapValue).fields).length)a.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];a.push(n.child(o))}else a.push(n)}),new ri(a)}(o.toProto().mapValue),es.exists(!0)))}return c._n.addMutationBatch(s,h,e,a)})}).then(function(t){return t.applyToLocalDocumentSet(u),{batchId:t.batchId,changes:u}}))];case 2:return s=t.sent(),l.sharedClientState.addPendingMutation(s.batchId),e=l,n=s.batchId,o=d,r=(r=(r=e.xo[e.currentUser.toKey()])||new As(Gr)).insert(n,o),e.xo[e.currentUser.toKey()]=r,[4,wh(l,s.changes)];case 3:return t.sent(),[4,Nc(l.remoteStore)];case 4:return t.sent(),[3,6];case 5:return l=t.sent(),l=Pc(l,"Failed to persist write"),d.reject(l),[3,6];case 6:return[2]}var e,n,r,a,u,c,h,i,o})})}function lh(r,i){return y(this,void 0,void 0,function(){var n,e;return g(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,au(n.localStore,i)];case 2:return e=t.sent(),i.targetChanges.forEach(function(t,e){e=n.Co.get(e);e&&(qr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),0<t.addedDocuments.size?e.bo=!0:0<t.modifiedDocuments.size?qr(e.bo):0<t.removedDocuments.size&&(qr(e.bo),e.bo=!1))}),[4,wh(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ha(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function fh(t,n,e){var r,t=t;(t.isPrimaryClient&&0===e||!t.isPrimaryClient&&1===e)&&(r=[],t.Po.forEach(function(t,e){e=e.view.zr(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zr(i)&&(o=!0)}),o&&Hc(t)}(t.eventManager,n),r.length&&t.vo._r(r),t.onlineState=n,t.isPrimaryClient&&t.sharedClientState.setOnlineState(n))}function ph(o,s){return y(this,void 0,void 0,function(){var n,r,i;return g(this,function(t){switch(t.label){case 0:Ec((n=o).remoteStore)||Mr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fo.get(r)||[]).push(s),n.Fo.set(r,i),[3,4]);case 3:return i=t.sent(),i=Pc(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function dh(t,e){(t.Fo.get(e)||[]).forEach(function(t){t.resolve()}),t.Fo.delete(e)}function yh(t,e,n){var r=t,i=r.xo[r.currentUser.toKey()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i)}function gh(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(t){e.No.containsKey(t)||vh(e,t)})}function vh(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(vc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),bh(t))}function mh(t,e,n){for(var r,i,o,s=0,a=n;s<a.length;s++){var u=a[s];u instanceof eh?(t.No.addReference(u.key,e),r=t,o=void 0,i=(o=(i=u).key).path.canonicalString(),r.Do.get(o)||r.So.has(i)||(Mr("SyncEngine","New document in limbo: "+o),r.So.add(i),bh(r))):u instanceof nh?(Mr("SyncEngine","Document no longer in limbo: "+u.key),t.No.removeReference(u.key,e),t.No.containsKey(u.key)||vh(t,u.key)):Ur()}}function bh(t){for(;0<t.So.size&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new mi(ti.fromString(e)),e=t.ko.next();t.Co.set(e,new oh(n)),t.Do=t.Do.insert(n,e),gc(t.remoteStore,new Pa(Ao(bo(n.path)),e,2,Nr.o))}}function wh(e,s,a){return y(this,void 0,void 0,function(){var n,r,i,o;return g(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Po.isEmpty()?[3,3]:(n.Po.forEach(function(t,e){o.push(n.Oo(e,s,a).then(function(t){t&&(n.isPrimaryClient&&n.sharedClientState.updateQueryState(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ya.Pn(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vo._r(r),[4,function(u,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,a;return g(this,function(t){switch(t.label){case 0:r=u,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Na.forEach(c,function(e){return Na.forEach(e.bn,function(t){return r.persistence.referenceDelegate.addReference(n,e.targetId,t)}).next(function(){return Na.forEach(e.vn,function(t){return r.persistence.referenceDelegate.removeReference(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Mr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)a=i[n],o=a.targetId,a.fromCache||(s=r.Fn.get(o),a=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(a),r.Fn=r.Fn.insert(o,a));return[2]}})})}(n.localStore,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function _h(i,o){return y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Mr("SyncEngine","User change. New user:",o.toKey()),[4,iu(n.localStore,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fo.forEach(function(t){t.forEach(function(t){t.reject(new kr(Rr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fo.clear(),n.sharedClientState.handleUserChange(o,r.removedBatchIds,r.addedBatchIds),[4,wh(n,r.Ln)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Eh(t,e,n){var r=t;!function(f,p,d){return y(this,void 0,void 0,function(){var a,u,c,h,l;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return a=t.sent(),[4,(r=f.localStore,o=r,s=aa((i=a).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Qe.getBundleMetadata(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.compareTo(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}))];case 4:return d._updateProgress(th(a)),u=new Yc(a,f.localStore,p.R),[4,p.Lo()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,u.oo(c)]:[3,10];case 7:return(h=t.sent())&&d._updateProgress(h),[4,p.Lo()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,u.complete()];case 11:return l=t.sent(),[4,wh(f,l.wn,void 0)];case 12:return t.sent(),[4,(r=f.localStore,e=a,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Qe.saveBundleMetadata(t,e)}))];case 13:return t.sent(),d._completeWith(l.progress),[3,15];case 14:return Fr("SyncEngine","Loading bundle failed with "+(l=t.sent())),d._failWith(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(r,e,n).then(function(){r.sharedClientState.notifyBundleLoaded()})}var Th=(Ah.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.R=$u(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Qo(e),[2]}})})},Ah.prototype.Uo=function(t){return null},Ah.prototype.Qo=function(t){return e=this.persistence,n=new Xa,r=t.initialUser,t=this.R,new Ja(e,n,r,t);var e,n,r},Ah.prototype.qo=function(t){return new _u(Tu.bs,this.R)},Ah.prototype.Bo=function(t){return new Vu},Ah.prototype.terminate=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},Ah),Ih=(Sh.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:return this.localStore?[3,2]:(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return fh(e.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=_h.bind(null,this.syncEngine),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,r?(e.Or.delete(2),[4,dc(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Or.add(2),[4,yc(e)]);case 3:t.sent(),e.Br.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Sh.prototype.createEventManager=function(t){return new Mc},Sh.prototype.createDatastore=function(t){var e=$u(t.databaseInfo.databaseId),n=(n=t.databaseInfo,new Gu(n));return t=t.credentials,new sc(t,n,e)},Sh.prototype.createRemoteStore=function(t){var e=this,n=this.localStore,r=this.datastore,i=t.asyncQueue,o=function(t){return fh(e.syncEngine,t,0)},t=new(qu.yt()?qu:Uu);return new Zu(n,r,i,o,t)},Sh.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){o=new sh(t,e,n,r,i,o);return s&&(o.$o=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},Sh.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,Mr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,yc(e)];case 1:return t.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},Sh);function Sh(){}function Ah(){this.synchronizeTabs=!1}function Nh(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Dh=(Fh.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},Fh.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Fh.prototype.Wo=function(){this.muted=!0},Fh.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Fh),Ch=(xh.prototype.close=function(){return this.Go.cancel()},xh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2,this.metadata.promise]})})},xh.prototype.Lo=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},xh.prototype.Ho=function(){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return[4,this.Jo()];case 1:return null===(e=t.sent())?[2,null]:(r=this.zo.decode(e),n=Number(r),isNaN(n)&&this.Yo("length string ("+r+") is not valid number"),[4,this.Xo(n)]);case 2:return r=t.sent(),[2,new Qc(JSON.parse(r),e.length+n)]}})})},xh.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},xh.prototype.Jo=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},xh.prototype.Xo=function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.tc()]:[3,3];case 1:t.sent()&&this.Yo("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},xh.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},xh.prototype.tc=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,this.Go.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},xh),Rh=(Mh.prototype.lookup=function(r){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new kr(Rr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return y(this,void 0,void 0,function(){var n,e,r,i,o;return g(this,function(t){switch(t.label){case 0:return e=pa((n=s).R)+"/documents",r={documents:a.map(function(t){return ha(n.R,t)})},[4,n.$i("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.R,"found"in(t=t)?function(t,e){qr(!!e.found),e.found.name,e.found.updateTime;var n=la(t,e.found.name),t=aa(e.found.updateTime),e=new Oi({mapValue:{fields:e.found.fields}});return Pi.newFoundDocument(n,t,e)}(e,t):"missing"in t?function(t,e){qr(!!e.missing),qr(!!e.readTime);t=la(t,e.missing),e=aa(e.readTime);return Pi.newNoDocument(t,e)}(e,t):Ur());i.set(t.key.toString(),t)}),o=[],[2,(a.forEach(function(t){t=i.get(t.toString());qr(!!t),o.push(t)}),o)]}})})}(this.datastore,r)];case 1:return[2,((e=t.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},Mh.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Mh.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},Mh.prototype.delete=function(t){this.write(new ws(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Mh.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=mi.fromPath(e);n.mutations.push(new _s(e,n.precondition(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=pa((e=i).R)+"/documents",r={writes:o.map(function(t){return ga(e.R,t)})},[4,e.Ni("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}})})},Mh.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Ur();e=Wr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new kr(Rr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},Mh.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?es.updateTime(e):es.none()},Mh.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(this.writtenDocs.has(t.toString())||!e)return es.exists(!0);if(e.isEqual(Wr.min()))throw new kr(Rr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return es.updateTime(e)},Mh.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},Mh.prototype.ensureCommitNotCalled=function(){},Mh),kh=(Ph.prototype.run=function(){this.nc()},Ph.prototype.nc=function(){var t=this;this.Zi.ji(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){return e=new Rh(this.datastore),(n=this.sc(e))&&n.then(function(t){r.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){r.deferred.resolve(t)}).catch(function(t){r.ic(t)})})}).catch(function(t){r.ic(t)}),[2]})})})},Ph.prototype.sc=function(t){try{var e=this.updateFunction(t);return!gi(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},Ph.prototype.ic=function(t){var e=this;0<this.ec&&this.rc(t)?(--this.ec,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},Ph.prototype.rc=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Is(t)},Ph),Oh=(Lh.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}})})},Lh.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then(function(){return e.credentialListener(e.user)})},Lh.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new kr(Rr.FAILED_PRECONDITION,"The client has already been terminated.")},Lh.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var n=new Aa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return e=t.sent(),e=Pc(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Lh);function Lh(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Iu.UNAUTHENTICATED,this.clientId=Br.u(),this.credentialListener=function(){},this.receivedInitialUser=new Aa,this.credentials.setChangeListener(function(t){Mr("FirestoreClient","Received user=",t.uid),r.user=t,r.credentialListener(t),r.receivedInitialUser.resolve()})}function Ph(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new rc(this.asyncQueue,"transaction_retry")}function Mh(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}function xh(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Aa,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Fh(t){this.observer=t,this.muted=!1}function Vh(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(Mr("FirestoreClient","Using default OfflineComponentProvider"),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){switch(t.label){case 0:return i.asyncQueue.verifyOperationInProgress(),Mr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.initialUser,i.setCredentialChangeListener(function(e){n.isEqual(e)||(n=e,i.asyncQueue.enqueueRetryable(function(){return y(r,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,iu(o.localStore,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.setDatabaseDeletedListener(function(){return i.terminate()}),i.offlineComponents=o,[2]}})})}(e,new Th)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function Uh(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(Mr("FirestoreClient","Using default OnlineComponentProvider"),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return r.asyncQueue.verifyOperationInProgress(),[4,Vh(r)];case 1:return e=t.sent(),Mr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.setCredentialChangeListener(function(t){return r.asyncQueue.enqueueRetryable(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=r).asyncQueue.verifyOperationInProgress(),Mr("RemoteStore","RemoteStore received new credentials"),n=Ec(e),e.Or.add(3),[4,yc(e)];case 1:return t.sent(),n&&e.Br.set("Unknown"),[4,e.remoteSyncer.handleCredentialChange(i)];case 2:return t.sent(),e.Or.delete(3),[4,dc(e)];case 3:return t.sent(),[2]}})})}(i.remoteStore,t)})}),r.onlineComponents=i,[2]}})})}(e,new Ih)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function qh(t){return Vh(t).then(function(t){return t.persistence})}function Bh(t){return Vh(t).then(function(t){return t.localStore})}function jh(t){return Uh(t).then(function(t){return t.remoteStore})}function Gh(t){return Uh(t).then(function(t){return t.syncEngine})}function Kh(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,Uh(r)];case 1:return e=t.sent(),[2,((n=e.eventManager).onListen=ch.bind(null,e.syncEngine),n.onUnlisten=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i).Po.get(o),1<(r=e.Vo.get(n.targetId)).length?[2,(e.Vo.set(n.targetId,r.filter(function(t){return!Do(t,o)})),void e.Po.delete(o))]:e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)?[3,2]:[4,hu(e.localStore,n.targetId,!1).then(function(){e.sharedClientState.clearQueryState(n.targetId),vc(e.remoteStore,n.targetId),gh(e,n.targetId)}).catch(Ha)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return gh(e,n.targetId),[4,hu(e.localStore,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.syncEngine),n)]}})})}function Hh(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new Dh({next:function(t){r.enqueueAndForget(function(){return Kc(n,a)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new kr(Rr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new kr(Rr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),a=new Wc(bo(i.path),t,{includeMetadataChanges:!0,so:!0});return Gc(n,a)},[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Wh(n,r,i){var t=this;void 0===i&&(i={});var o=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new Dh({next:function(t){n.enqueueAndForget(function(){return Kc(e,s)}),t.fromCache&&"server"===r.source?i.reject(new kr(Rr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Wc(t,o,{includeMetadataChanges:!0,so:!0});return Gc(e,s)},[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Qh(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t}var zh=function(t,e,n,r,i,o,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s},Yh=(Object.defineProperty(al.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),al.prototype.isEqual=function(t){return t instanceof al&&t.projectId===this.projectId&&t.database===this.database},al),Xh=new Map,Jh=(sl.prototype.getToken=function(){return Promise.resolve(null)},sl.prototype.invalidateToken=function(){},sl.prototype.setChangeListener=function(t){(this.changeListener=t)(Iu.UNAUTHENTICATED)},sl.prototype.removeChangeListener=function(){this.changeListener=null},sl),$h=(ol.prototype.getToken=function(){return Promise.resolve(this.token)},ol.prototype.invalidateToken=function(){},ol.prototype.setChangeListener=function(t){(this.changeListener=t)(this.token.user)},ol.prototype.removeChangeListener=function(){this.changeListener=null},ol),Zh=(il.prototype.getToken=function(){var e=this,n=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.cc!==n?(Mr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(qr("string"==typeof t.accessToken),new Qh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},il.prototype.invalidateToken=function(){this.forceRefresh=!0},il.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},il.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.oc),this.oc=null,this.changeListener=null},il.prototype.uc=function(){var t=this.auth&&this.auth.getUid();return qr(null===t||"string"==typeof t),new Iu(t)},il),tl=(Object.defineProperty(rl.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.hc},e=this.ac.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.lc&&(t["X-Goog-Iam-Authorization-Token"]=this.lc),t},enumerable:!1,configurable:!0}),rl),el=(nl.prototype.getToken=function(){return Promise.resolve(new tl(this.ac,this.hc,this.lc))},nl.prototype.setChangeListener=function(t){t(Iu.FIRST_PARTY)},nl.prototype.removeChangeListener=function(){},nl.prototype.invalidateToken=function(){},nl);function nl(t,e,n){this.ac=t,this.hc=e,this.lc=n}function rl(t,e,n){this.ac=t,this.hc=e,this.lc=n,this.type="FirstParty",this.user=Iu.FIRST_PARTY}function il(t){var e=this;this.oc=null,this.currentUser=Iu.UNAUTHENTICATED,this.receivedInitialUser=!1,this.cc=0,this.changeListener=null,this.forceRefresh=!1,this.oc=function(){e.cc++,e.currentUser=e.uc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.cc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oc):(this.oc(null),t.get().then(function(t){e.auth=t,e.oc&&e.auth.addAuthTokenListener(e.oc)},function(){}))}function ol(t){this.token=t,this.changeListener=null}function sl(){this.changeListener=null}function al(t,e){this.projectId=t,this.database=e||"(default)"}function ul(t,e,n){if(!n)throw new kr(Rr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function cl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new kr(Rr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function hl(t,e,n,r){if(!0===e&&!0===r)throw new kr(Rr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function ll(t){if(!mi.isDocumentKey(t))throw new kr(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function fl(t){if(mi.isDocumentKey(t))throw new kr(Rr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function pl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ur();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function dl(t,e){if((t="_delegate"in t?t._delegate:t)instanceof e)return t;if(e.name===t.constructor.name)throw new kr(Rr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=pl(t);throw new kr(Rr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function yl(t,e){if(e<=0)throw new kr(Rr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var gl,vl=(Al.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Al),ml=(Object.defineProperty(Sl.prototype,"app",{get:function(){if(!this._app)throw new kr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(Sl.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),Sl.prototype._setSettings=function(t){if(this._settingsFrozen)throw new kr(Rr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new vl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Jh;switch(t.type){case"gapi":var e=t.client;return qr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new el(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new kr(Rr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Sl.prototype._getSettings=function(){return this._settings},Sl.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},Sl.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},Sl.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},Sl.prototype._terminate=function(){return(t=Xh.get(this))&&(Mr("ComponentProvider","Removing Datastore"),Xh.delete(this),t.terminate()),Promise.resolve();var t},Sl),bl=(Object.defineProperty(Il.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"parent",{get:function(){return new _l(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),Il.prototype.withConverter=function(t){return new Il(this.firestore,t,this._key)},Il),wl=(Tl.prototype.withConverter=function(t){return new Tl(this.firestore,t,this._query)},Tl),_l=(n(El,gl=wl),Object.defineProperty(El.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(El.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(El.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new bl(this.firestore,null,new mi(t))},enumerable:!1,configurable:!0}),El.prototype.withConverter=function(t){return new El(this.firestore,t,this._path)},El);function El(t,e,n){var r=this;return(r=gl.call(this,t,e,bo(n))||this)._path=n,r.type="collection",r}function Tl(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}function Il(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}function Sl(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new vl({}),this._settingsFrozen=!1,t instanceof Yh?(this._databaseId=t,this._credentials=new Jh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new kr(Rr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yh(t.options.projectId)}(t),this._credentials=new Zh(e))}function Al(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new kr(Rr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new kr(Rr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,hl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Nl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=m(t),ul("collection","path",e),t instanceof ml)return fl(n=ti.fromString.apply(ti,s([e],r))),new _l(t,null,n);if(!(t instanceof bl||t instanceof _l))throw new kr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return fl(n=ti.fromString.apply(ti,s([t.path],r)).child(ti.fromString(e))),new _l(t.firestore,null,n)}function Dl(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=m(t),ul("doc","path",e=1===arguments.length?Br.u():e),t instanceof ml)return ll(n=ti.fromString.apply(ti,s([e],r))),new bl(t,null,new mi(n));if(!(t instanceof bl||t instanceof _l))throw new kr(Rr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return ll(n=t._path.child(ti.fromString.apply(ti,s([e],r)))),new bl(t.firestore,t instanceof _l?t.converter:null,new mi(n))}function Cl(t,e){return t=m(t),e=m(e),(t instanceof bl||t instanceof _l)&&(e instanceof bl||e instanceof _l)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Rl(t,e){return t=m(t),e=m(e),t instanceof wl&&e instanceof wl&&t.firestore===e.firestore&&Do(t._query,e._query)&&t.converter===e.converter}var kl=(Object.defineProperty(Ol.prototype,"isShuttingDown",{get:function(){return this.wc},enumerable:!1,configurable:!0}),Ol.prototype.enqueueAndForget=function(t){this.enqueue(t)},Ol.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Tc(),this.Ic(t)},Ol.prototype.enterRestrictedMode=function(){var t;this.wc||(this.wc=!0,(t=Ju())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ec))},Ol.prototype.enqueue=function(t){return this.Tc(),this.wc?new Promise(function(t){}):this.Ic(t)},Ol.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.dc.push(t),e.Ac()})},Ol.prototype.Ac=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(0===this.dc.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.dc[0]()];case 2:return t.sent(),this.dc.shift(),this.Zi.reset(),[3,4];case 3:if(!Ra(e=t.sent()))throw e;return Mr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.dc.length&&this.Zi.ji(function(){return n.Ac()}),t.label=5;case 5:return[2]}})})},Ol.prototype.Ic=function(t){var r=this,e=this.fc.then(function(){return r.yc=!0,t().catch(function(t){throw r.mc=t,r.yc=!1,xr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.yc=!1,t})});return this.fc=e},Ol.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Tc(),-1<this.gc.indexOf(t)&&(e=0);n=Oc.createAndSchedule(this,t,e,n,function(t){return r.Rc(t)});return this._c.push(n),n},Ol.prototype.Tc=function(){this.mc&&Ur()},Ol.prototype.verifyOperationInProgress=function(){},Ol.prototype.bc=function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,e=this.fc];case 1:t.sent(),t.label=2;case 2:if(e!==this.fc)return[3,0];t.label=3;case 3:return[2]}})})},Ol.prototype.vc=function(t){for(var e=0,n=this._c;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},Ol.prototype.Pc=function(r){var i=this;return this.bc().then(function(){i._c.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var t=0,e=i._c;t<e.length;t++){var n=e[t];if(n.skipDelay(),"all"!==r&&n.timerId===r)break}return i.bc()})},Ol.prototype.Vc=function(t){this.gc.push(t)},Ol.prototype.Rc=function(t){t=this._c.indexOf(t);this._c.splice(t,1)},Ol);function Ol(){var e=this;this.fc=Promise.resolve(),this.dc=[],this.wc=!1,this._c=[],this.mc=null,this.yc=!1,this.gc=[],this.Zi=new rc(this,"async_queue_retry"),this.Ec=function(){var t=Ju();t&&Mr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=Ju();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ec)}function Ll(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Pl,Ml=(Vl.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},Vl.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},Vl.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},Vl.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},Vl.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},Vl.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},Vl),xl=(n(Fl,Pl=ml),Fl.prototype._terminate=function(){return this._firestoreClient||ql(this),this._firestoreClient.terminate()},Fl);function Fl(t,e){var n=this;return(n=Pl.call(this,t,e)||this).type="firestore",n._queue=new kl,n._persistenceKey="name"in t?t.name:"[DEFAULT]",n}function Vl(){this._progressObserver={},this._taskCompletionResolver=new Aa,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Ul(t){return t._firestoreClient||ql(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function ql(t){var e,n,r,i=t._freezeSettings(),i=(e=t._databaseId,n=(null===(r=t._app)||void 0===r?void 0:r.options.appId)||"",r=t._persistenceKey,new zh(e,n,r,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling));t._firestoreClient=new Oh(t._credentials,t._queue,i)}var Bl=($l.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},$l),jl=(Jl.fromBase64String=function(t){try{return new Jl(ii.fromBase64String(t))}catch(t){throw new kr(Rr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Jl.fromUint8Array=function(t){return new Jl(ii.fromUint8Array(t))},Jl.prototype.toBase64=function(){return this._byteString.toBase64()},Jl.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},Jl.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Jl.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},Jl),Gl=function(t){this._methodName=t},Kl=(Object.defineProperty(Xl.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(Xl.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),Xl.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},Xl.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},Xl.prototype._compareTo=function(t){return Gr(this._lat,t._lat)||Gr(this._long,t._long)},Xl),Hl=/^__.*__$/,Wl=(Yl.prototype.toMutation=function(t,e){return null!==this.fieldMask?new hs(t,this.data,this.fieldMask,e,this.fieldTransforms):new cs(t,this.data,e,this.fieldTransforms)},Yl),Ql=(zl.prototype.toMutation=function(t,e){return new hs(t,this.data,this.fieldMask,e,this.fieldTransforms)},zl);function zl(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Yl(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Xl(t,e){if(!isFinite(t)||t<-90||90<t)throw new kr(Rr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new kr(Rr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}function Jl(t){this._byteString=t}function $l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new kr(Rr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ni(t)}function Zl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ur()}}var tf=(Object.defineProperty(rf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(rf.prototype,"Dc",{get:function(){return this.settings.Dc},enumerable:!1,configurable:!0}),rf.prototype.Cc=function(t){return new rf(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},rf.prototype.Nc=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Cc({path:e,xc:!1});return e.Fc(t),e},rf.prototype.kc=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Cc({path:t,xc:!1});return t.Sc(),t},rf.prototype.$c=function(t){return this.Cc({path:void 0,xc:!0})},rf.prototype.Oc=function(t){return Lf(t,this.settings.methodName,this.settings.Mc||!1,this.path,this.settings.Lc)},rf.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},rf.prototype.Sc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Fc(this.path.get(t))},rf.prototype.Fc=function(t){if(0===t.length)throw this.Oc("Document fields must not be empty");if(Zl(this.Dc)&&Hl.test(t))throw this.Oc('Document fields cannot begin and end with "__"')},rf),ef=(nf.prototype.Bc=function(t,e,n,r){return void 0===r&&(r=!1),new tf({Dc:t,methodName:e,Lc:n,path:ni.emptyPath(),xc:!1,Mc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},nf);function nf(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||$u(t)}function rf(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}function of(t){var e=t._freezeSettings(),n=$u(t._databaseId);return new ef(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Bc(o.merge||o.mergeFields?2:0,e,n,i);Cf("Data must be an object, but it was:",s,r);var a,u,r=Nf(r,s);if(o.merge)a=new ri(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=Rf(e,l[h],n);if(!s.contains(f))throw new kr(Rr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Pf(c,f)||c.push(f)}a=new ri(c),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Wl(new Oi(r),a,u)}var af,uf=(n(cf,af=Gl),cf.prototype._toFieldTransform=function(t){if(2!==t.Dc)throw 1===t.Dc?t.Oc(this._methodName+"() can only appear at the top level of your update data"):t.Oc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},cf.prototype.isEqual=function(t){return t instanceof cf},cf);function cf(){return null!==af&&af.apply(this,arguments)||this}function hf(t,e,n){return new tf({Dc:3,Lc:e.settings.Lc,methodName:t._methodName,xc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var lf,ff,pf,df,yf=(n(Ef,df=Gl),Ef.prototype._toFieldTransform=function(t){return new Zo(t.path,new Uo)},Ef.prototype.isEqual=function(t){return t instanceof Ef},Ef),gf=(n(_f,pf=Gl),_f.prototype._toFieldTransform=function(t){var e=hf(this,t,!0),n=this.qc.map(function(t){return Af(t,e)}),n=new qo(n);return new Zo(t.path,n)},_f.prototype.isEqual=function(t){return this===t},_f),vf=(n(wf,ff=Gl),wf.prototype._toFieldTransform=function(t){var e=hf(this,t,!0),n=this.qc.map(function(t){return Af(t,e)}),n=new Ho(n);return new Zo(t.path,n)},wf.prototype.isEqual=function(t){return this===t},wf),mf=(n(bf,lf=Gl),bf.prototype._toFieldTransform=function(t){var e=new Yo(t.R,Mo(t.R,this.Uc));return new Zo(t.path,e)},bf.prototype.isEqual=function(t){return this===t},bf);function bf(t,e){var n=this;return(n=lf.call(this,t)||this).Uc=e,n}function wf(t,e){var n=this;return(n=ff.call(this,t)||this).qc=e,n}function _f(t,e){var n=this;return(n=pf.call(this,t)||this).qc=e,n}function Ef(){return null!==df&&df.apply(this,arguments)||this}function Tf(t,r,i,e){var o=t.Bc(1,r,i);Cf("Data must be an object, but it was:",o,e);var s=[],a=Oi.empty();Xr(e,function(t,e){var n=Of(r,t,i);e=m(e);t=o.kc(n);e instanceof uf?s.push(n):null!=(t=Af(e,t))&&(s.push(n),a.set(n,t))});e=new ri(s);return new Ql(a,e,o.fieldTransforms)}function If(t,e,n,r,i,o){var s=t.Bc(1,e,n),a=[Rf(e,r,n)],u=[i];if(o.length%2!=0)throw new kr(Rr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Rf(e,o[c])),u.push(o[c+1]);for(var h,l,f,p=[],d=Oi.empty(),y=a.length-1;0<=y;--y)Pf(p,a[y])||(h=a[y],l=m(l=u[y]),f=s.kc(h),l instanceof uf?p.push(h):null!=(f=Af(l,f))&&(p.push(h),d.set(h,f)));i=new ri(p);return new Ql(d,i,s.fieldTransforms)}function Sf(t,e,n,r){return void 0===r&&(r=!1),Af(n,t.Bc(r?4:3,e))}function Af(s,t){if(Df(s=m(s)))return Cf("Unsupported field value:",t,s),Nf(s,t);if(s instanceof Gl)return function(t,e){if(!Zl(e.Dc))throw e.Oc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Oc(t._methodName+"() is not currently supported inside arrays");t=t._toFieldTransform(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),s instanceof Array){if(t.settings.xc&&4!==t.Dc)throw t.Oc("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Af(i[r],t.$c(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=m(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Mo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Hr.fromDate(t);return{timestampValue:oa(e.R,n)}}if(t instanceof Hr)return n=new Hr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:oa(e.R,n)};if(t instanceof Kl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof jl)return{bytesValue:sa(e.R,t._byteString)};if(t instanceof bl){var n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Oc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ua(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Oc("Unsupported field value: "+pl(t))}(s,t)}function Nf(t,n){var r={};return Jr(t)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):Xr(t,function(t,e){e=Af(e,n.Nc(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Df(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Hr||t instanceof Kl||t instanceof jl||t instanceof bl||t instanceof Gl)}function Cf(t,e,n){if(!Df(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=pl(n);throw"an object"===n?e.Oc(t+" a custom object"):e.Oc(t+" "+n)}var r}function Rf(t,e,n){if((e=m(e))instanceof Bl)return e._internalPath;if("string"==typeof e)return Of(t,e);throw Lf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var kf=new RegExp("[~\\*/\\[\\]]");function Of(e,n,r){if(0<=n.search(kf))throw Lf("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Bl.bind.apply(Bl,s([void 0],n.split(".")))))._internalPath}catch(t){throw Lf("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Lf(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new kr(Rr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Pf(t,e){return t.some(function(t){return t.isEqual(e)})}var Mf,xf=(Object.defineProperty(Uf.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Uf.prototype,"ref",{get:function(){return new bl(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),Uf.prototype.exists=function(){return null!==this._document},Uf.prototype.data=function(){if(this._document){if(this._converter){var t=new Ff(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},Uf.prototype.get=function(t){if(this._document){t=this._document.data.field(qf("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t)}},Uf),Ff=(n(Vf,Mf=xf),Vf.prototype.data=function(){return Mf.prototype.data.call(this)},Vf);function Vf(){return null!==Mf&&Mf.apply(this,arguments)||this}function Uf(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}function qf(t,e){return"string"==typeof e?Of(t,e):(e instanceof Bl?e:e._delegate)._internalPath}var Bf,jf,Gf=(Xf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Xf),Kf=(n(Yf,jf=xf),Yf.prototype.exists=function(){return jf.prototype.exists.call(this)},Yf.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Hf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},Yf.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){t=this._document.data.field(qf("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t,e.serverTimestamps)}},Yf),Hf=(n(zf,Bf=Kf),zf.prototype.data=function(t){return void 0===t&&(t={}),Bf.prototype.data.call(this,t)},zf),Wf=(Object.defineProperty(Qf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Qf.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Qf.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Qf.prototype.forEach=function(e,n){var r=this;this._snapshot.docs.forEach(function(t){e.call(n,new Hf(r._firestore,r._userDataWriter,t.key,t,new Gf(r._snapshot.mutatedKeys.has(t.key),r._snapshot.fromCache),r.query.converter))})},Qf.prototype.docChanges=function(t){t=!!(t=void 0===t?{}:t).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new kr(Rr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,e){if(i._snapshot.oldDocs.isEmpty()){var n=0;return i._snapshot.docChanges.map(function(t){var e=new Hf(i._firestore,i._userDataWriter,t.doc.key,t.doc,new Gf(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Hf(i._firestore,i._userDataWriter,t.doc.key,t.doc,new Gf(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ur()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},Qf);function Qf(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Gf(r.hasPendingWrites,r.fromCache),this.query=n}function zf(){return null!==Bf&&Bf.apply(this,arguments)||this}function Yf(t,e,n,r,i,o){var s=this;return(s=jf.call(this,t,e,n,r,o)||this)._firestore=t,s._firestoreImpl=t,s.metadata=i,s}function Xf(t,e){this.hasPendingWrites=t,this.fromCache=e}function Jf(t,e){return t instanceof Kf&&e instanceof Kf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Wf&&e instanceof Wf&&t._firestore===e._firestore&&Rl(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function $f(t){if(_o(t)&&0===t.explicitOrderBy.length)throw new kr(Rr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}Se=function(){};function Zf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r]._apply(t);return t}var tp,ep,np,rp,ip,op=(n(dp,ip=Se),dp.prototype._apply=function(t){var e=of(t.firestore),e=function(t,e,n,r,i,o){if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new kr(Rr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){vp(o,i);for(var s=[],a=0,u=o;a<u.length;a++){var c=u[a];s.push(gp(n,t,c))}h={arrayValue:{values:s}}}else h=gp(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||vp(o,i),h=Sf(e,"where",o,"in"===i||"not-in"===i);var h=ji.create(r,i,h);return function(t,e){if(e.g()){var n=To(t);if(null!==n&&!n.isEqual(e.field))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Eo(t);null!==n&&mp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new kr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new kr(Rr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t._query,e,t.firestore._databaseId,this.Qc,this.Kc,this.jc);return new wl(t.firestore,t.converter,(t=t._query,e=t.filters.concat([e]),new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},dp),sp=(n(pp,rp=Se),pp.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new yo(e,n);return e=r,null!==Eo(n=t)||null!==(t=To(n))&&mp(0,t,e.field),r}(t._query,this.Qc,this.Wc);return new wl(t.firestore,t.converter,(t=t._query,e=t.explicitOrderBy.concat([e]),new mo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},pp),ap=(n(fp,np=Se),fp.prototype._apply=function(t){return new wl(t.firestore,t.converter,No(t._query,this.Gc,this.zc))},fp),up=(n(lp,ep=Se),lp.prototype._apply=function(t){var e=yp(t,this.type,this.Hc,this.Jc);return new wl(t.firestore,t.converter,(t=t._query,e=e,new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},lp),cp=(n(hp,tp=Se),hp.prototype._apply=function(t){var e=yp(t,this.type,this.Hc,this.Jc);return new wl(t.firestore,t.converter,(t=t._query,e=e,new mo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},hp);function hp(t,e,n){var r=this;return(r=tp.call(this)||this).type=t,r.Hc=e,r.Jc=n,r}function lp(t,e,n){var r=this;return(r=ep.call(this)||this).type=t,r.Hc=e,r.Jc=n,r}function fp(t,e,n){var r=this;return(r=np.call(this)||this).type=t,r.Gc=e,r.zc=n,r}function pp(t,e){var n=this;return(n=rp.call(this)||this).Qc=t,n.Wc=e,n.type="orderBy",n}function dp(t,e,n){var r=this;return(r=ip.call(this)||this).Qc=t,r.Kc=e,r.jc=n,r.type="where",r}function yp(t,c,e,n){if(e[0]=m(e[0]),e[0]instanceof xf)return function(t,e,n,r){if(!n)throw new kr(Rr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=So(t);o<s.length;o++){var a=s[o];if(a.field.isKeyField())i.push(Ai(e,n.key));else{var u=n.data.field(a.field);if(di(u))throw new kr(Rr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){a=a.field.canonicalString();throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}i.push(u)}}return new uo(i,r)}(t._query,t.firestore._databaseId,e[0]._document,n);var r=of(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new kr(Rr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Io(t)&&-1!==c.indexOf("/"))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ti.fromString(c));if(!mi.isDocumentKey(h))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new mi(h);a.push(Ai(e,h))}else{c=Sf(n,r,c);a.push(c)}}return new uo(a,o)}(t._query,t.firestore._databaseId,r,c,e,n)}function gp(t,e,n){if("string"==typeof(n=m(n))){if(""===n)throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Io(e)&&-1!==n.indexOf("/"))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ti.fromString(n));if(!mi.isDocumentKey(e))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ai(t,new mi(e))}if(n instanceof bl)return Ai(t,n._key);throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pl(n)+".")}function vp(t,e){if(!Array.isArray(t)||0===t.length)throw new kr(Rr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new kr(Rr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function mp(t,e,n){if(!n.isEqual(e))throw new kr(Rr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}bp.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),wi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return fi(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(pi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ur()}},bp.prototype.convertObject=function(t,n){var r=this,i={};return Xr(t.fields||{},function(t,e){i[t]=r.convertValue(e,n)}),i},bp.prototype.convertGeoPoint=function(t){return new Kl(fi(t.latitude),fi(t.longitude))},bp.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},bp.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return di(e)?t(e):e}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(yi(t));default:return null}},bp.prototype.convertTimestamp=function(t){t=li(t);return new Hr(t.seconds,t.nanos)},bp.prototype.convertDocumentKey=function(t,e){var n=ti.fromString(t);qr(Sa(n));t=new Yh(n.get(1),n.get(3)),n=new mi(n.popFirst(5));return t.isEqual(e)||xr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},T=bp;function bp(){}function wp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var _p,Ep=(n(Sp,_p=T),Sp.prototype.convertBytes=function(t){return new jl(t)},Sp.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new bl(this.firestore,null,t)},Sp),Tp=(Ip.prototype.set=function(t,e,n){this._verifyNotCommitted();t=Ap(t,this._firestore),e=wp(t.converter,e,n),n=sf(this._dataReader,"WriteBatch.set",t._key,e,null!==t.converter,n);return this._mutations.push(n.toMutation(t._key,es.none())),this},Ip.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();t=Ap(t,this._firestore),e="string"==typeof(e=m(e))||e instanceof Bl?If(this._dataReader,"WriteBatch.update",t._key,e,n,r):Tf(this._dataReader,"WriteBatch.update",t._key,e);return this._mutations.push(e.toMutation(t._key,es.exists(!0))),this},Ip.prototype.delete=function(t){this._verifyNotCommitted();t=Ap(t,this._firestore);return this._mutations=this._mutations.concat(new ws(t._key,es.none())),this},Ip.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},Ip.prototype._verifyNotCommitted=function(){if(this._committed)throw new kr(Rr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ip);function Ip(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=of(t)}function Sp(t){var e=this;return(e=_p.call(this)||this).firestore=t,e}function Ap(t,e){if((t=m(t)).firestore!==e)throw new kr(Rr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Np,Dp=(n(Cp,Np=T),Cp.prototype.convertBytes=function(t){return new jl(t)},Cp.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new bl(this.firestore,null,t)},Cp);function Cp(t){var e=this;return(e=Np.call(this)||this).firestore=t,e}function Rp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=dl(t,bl);var o=dl(t.firestore,xl),s=of(o);return Op(o,[("string"==typeof(e=m(e))||e instanceof Bl?If(s,"updateDoc",t._key,e,n,r):Tf(s,"updateDoc",t._key,e)).toMutation(t._key,es.exists(!0))])}function kp(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e=m(e);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ll(n[i])||(r=n[i],i++);var o,s,a,u,c,h,l={includeMetadataChanges:r.includeMetadataChanges};return Ll(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof bl?(a=dl(e.firestore,xl),u=bo(e._key.path),h={next:function(t){n[i]&&n[i](Lp(a,e,t))},error:n[i+1],complete:n[i+2]}):(s=dl(e,wl),a=dl(s.firestore,xl),u=s._query,c=new Dp(a),h={next:function(t){n[i]&&n[i](new Wf(a,c,s,t))},error:n[i+1],complete:n[i+2]},$f(e._query)),function(n,t,e){var r=this,i=new Dh(h),o=new Wc(t,i,e);return n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Gc,[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Kc,[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Ul(a),u,l)}function Op(t,e){return function(n,r){var t=this,i=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=hh,[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Ul(t),e)}function Lp(t,e,n){var r=n.docs.get(e._key),i=new Dp(t);return new Kf(t,i,e._key,r,new Gf(n.hasPendingWrites,n.fromCache),e.converter)}var Pp,Mp=(Fp.prototype.get=function(t){var e=this,n=Ap(t,this._firestore),r=new Ep(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return Ur();t=t[0];if(t.isFoundDocument())return new xf(e._firestore,r,t.key,t,n.converter);if(t.isNoDocument())return new xf(e._firestore,r,n._key,null,n.converter);throw Ur()})},Fp.prototype.set=function(t,e,n){t=Ap(t,this._firestore),e=wp(t.converter,e,n),n=sf(this._dataReader,"Transaction.set",t._key,e,null!==t.converter,n);return this._transaction.set(t._key,n),this},Fp.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ap(t,this._firestore),e="string"==typeof(e=m(e))||e instanceof Bl?If(this._dataReader,"Transaction.update",t._key,e,n,r):Tf(this._dataReader,"Transaction.update",t._key,e);return this._transaction.update(t._key,e),this},Fp.prototype.delete=function(t){t=Ap(t,this._firestore);return this._transaction.delete(t._key),this},n(xp,Pp=Fp),xp.prototype.get=function(t){var e=this,n=Ap(t,this._firestore),r=new Dp(this._firestore);return Pp.prototype.get.call(this,t).then(function(t){return new Kf(e._firestore,r,n._key,t._document,new Gf(!1,!1),n.converter)})},xp);function xp(t,e){var n=this;return(n=Pp.call(this,t,e)||this)._firestore=t,n}function Fp(t,e){this._firestore=t,this._transaction=e,this._dataReader=of(t)}function Vp(){if("undefined"==typeof Uint8Array)throw new kr(Rr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Up(){if("undefined"==typeof atob)throw new kr(Rr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var qp,Bp=(Yp.fromBase64String=function(t){return Up(),new Yp(jl.fromBase64String(t))},Yp.fromUint8Array=function(t){return Vp(),new Yp(jl.fromUint8Array(t))},Yp.prototype.toBase64=function(){return Up(),this._delegate.toBase64()},Yp.prototype.toUint8Array=function(){return Vp(),this._delegate.toUint8Array()},Yp.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},Yp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yp),jp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Gp=(zp.prototype.enableIndexedDbPersistence=function(t,e){throw new kr(Rr.FAILED_PRECONDITION,jp)},zp.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new kr(Rr.FAILED_PRECONDITION,jp)},zp.prototype.clearIndexedDbPersistence=function(t){throw new kr(Rr.FAILED_PRECONDITION,jp)},zp),Kp=(Object.defineProperty(Qp.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),Qp.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},Qp.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var i=(t=dl(t,ml))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Fr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:e+":"+n,ssl:!1})),r.mockUserToken){n=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0;if(!(e=t.sub||t.user_id))throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");return t=o({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}}},t),[a.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),a.encodeString(JSON.stringify(t),!1),""].join(".")}(r.mockUserToken),r=r.mockUserToken.sub||r.mockUserToken.user_id;if(!r)throw new kr(Rr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new $h(new Qh(n,new Iu(r)))}}(this._delegate,t,e,n)},Qp.prototype.enableNetwork=function(){return function(i){var t=this;return i.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,qh(i)];case 1:return n=t.sent(),[4,jh(i)];case 2:return r=t.sent(),[2,(n.setNetworkEnabled(!0),(e=r).Or.delete(0),dc(e))]}var e})})})}(Ul(dl(this._delegate,xl)))},Qp.prototype.disableNetwork=function(){return function(r){var t=this;return r.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,qh(r)];case 1:return e=t.sent(),[4,jh(r)];case 2:return n=t.sent(),[2,(e.setNetworkEnabled(!1),function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).Or.add(0),[4,yc(e)];case 1:return t.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(Ul(dl(this._delegate,xl)))},Qp.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&hl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Yc.enableMultiTabIndexedDbPersistence(this):this.Yc.enableIndexedDbPersistence(this,n)},Qp.prototype.clearPersistence=function(){return this.Yc.clearIndexedDbPersistence(this)},Qp.prototype.terminate=function(){return this.Xc&&(this.Xc._removeServiceInstance("firestore"),this.Xc._removeServiceInstance("firestore-exp")),this._delegate._delete()},Qp.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=ph,[4,Gh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Ul(dl(this._delegate,xl)))},Qp.prototype.onSnapshotsInSync=function(t){return e=this._delegate,t=t,function(n,t){var e=this,r=new Dh(t);return n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.add(e),e.next()},[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.delete(e)},[4,Kh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Ul(dl(e,xl)),Ll(t)?t:{next:t});var e},Object.defineProperty(Qp.prototype,"app",{get:function(){if(!this.Xc)throw new kr(Rr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xc},enumerable:!1,configurable:!0}),Qp.prototype.collection=function(t){try{return new dd(this,Nl(this._delegate,t))}catch(t){throw id(t,"collection()","Firestore.collection()")}},Qp.prototype.doc=function(t){try{return new nd(this,Dl(this._delegate,t))}catch(t){throw id(t,"doc()","Firestore.doc()")}},Qp.prototype.collectionGroup=function(t){try{return new ld(this,function(t,e){if(t=dl(t,ml),ul("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new kr(Rr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new wl(t,null,(e=e,new mo(ti.emptyPath(),e)))}(this._delegate,t))}catch(t){throw id(t,"collectionGroup()","Firestore.collectionGroup()")}},Qp.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,Uh(n).then(function(t){return t.datastore})];case 1:return e=t.sent(),new kh(n.asyncQueue,e,r,i).run(),[2]}})})}),i.promise}(Ul(n=this._delegate),function(t){return t=new Mp(n,t),e(new Xp(r,t))})},Qp.prototype.batch=function(){var e=this;return Ul(this._delegate),new Jp(new Tp(this._delegate,function(t){return Op(e._delegate,t)}))},Qp.prototype.loadBundle=function(t){throw new kr(Rr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp.prototype.namedQuery=function(t){throw new kr(Rr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Qp),Hp=(n(Wp,qp=T),Wp.prototype.convertBytes=function(t){return new Bp(new jl(t))},Wp.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return nd.Zc(t,this.firestore,null)},Wp);function Wp(t){var e=this;return(e=qp.call(this)||this).firestore=t,e}function Qp(t,e,n){var r=this;this._delegate=e,this.Yc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Yh||(this.Xc=t)}function zp(){}function Yp(t){this._delegate=t}var Xp=(ed.prototype.get=function(t){var e=this,n=_d(t);return this._delegate.get(n).then(function(t){return new cd(e._firestore,new Kf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},ed.prototype.set=function(t,e,n){t=_d(t);return n?(cl("Transaction.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},ed.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=_d(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},ed.prototype.delete=function(t){t=_d(t);return this._delegate.delete(t),this},ed),Jp=(td.prototype.set=function(t,e,n){t=_d(t);return n?(cl("WriteBatch.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},td.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=_d(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},td.prototype.delete=function(t){t=_d(t);return this._delegate.delete(t),this},td.prototype.commit=function(){return this._delegate.commit()},td),$p=(Zp.prototype.fromFirestore=function(t,e){t=new Hf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new hd(this._firestore,t),null!=e?e:{})},Zp.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},Zp.tu=function(t,e){var n=Zp.eu,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new Zp(t,new Hp(t),e),r.set(e,n)),n},Zp);function Zp(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}function td(t){this._delegate=t}function ed(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Hp(t)}$p.eu=new WeakMap;var nd=(rd.nu=function(t,e,n){if(t.length%2!=0)throw new kr(Rr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new rd(e,new bl(e._delegate,n,new mi(t)))},rd.Zc=function(t,e,n){return new rd(e,new bl(e._delegate,n,t))},Object.defineProperty(rd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"parent",{get:function(){return new dd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(rd.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),rd.prototype.collection=function(t){try{return new dd(this.firestore,Nl(this._delegate,t))}catch(t){throw id(t,"collection()","DocumentReference.collection()")}},rd.prototype.isEqual=function(t){return(t=m(t))instanceof bl&&Cl(this._delegate,t)},rd.prototype.set=function(t,e){e=cl("DocumentReference.set",e);try{return function(t,e,n){t=dl(t,bl);var r=dl(t.firestore,xl),e=wp(t.converter,e,n);return Op(r,[sf(of(r),"setDoc",t._key,e,null!==t.converter,n).toMutation(t._key,es.none())])}(this._delegate,t,e)}catch(t){throw id(t,"setDoc()","DocumentReference.set()")}},rd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Rp(this._delegate,t):Rp.apply(void 0,s([this._delegate,t,e],n))}catch(t){throw id(t,"updateDoc()","DocumentReference.update()")}},rd.prototype.delete=function(){return Op(dl((t=this._delegate).firestore,xl),[new ws(t._key,es.none())]);var t},rd.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=od(t),i=sd(t,function(t){return new cd(e.firestore,new Kf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))});return kp(this._delegate,r,i)},rd.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=dl(e,bl);var n=dl(e.firestore,xl),t=Ul(n),r=new Dp(n);return function(n,r){var t=this,i=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(o,s,a){return y(this,void 0,void 0,function(){var r,i;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)}))];case 1:return(i=t.sent()).isFoundDocument()?a.resolve(i):i.isNoDocument()?a.resolve(null):a.reject(new kr(Rr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=Pc(r,"Failed to get document '"+s+" from cache"),a.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Bh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._key).then(function(t){return new Kf(n,r,e._key,t,new Gf(null!==t&&t.hasLocalMutations,!0),e.converter)})}:"server"===(null==t?void 0:t.source)?function(e){e=dl(e,bl);var n=dl(e.firestore,xl);return Hh(Ul(n),e._key,{source:"server"}).then(function(t){return Lp(n,e,t)})}:function(e){e=dl(e,bl);var n=dl(e.firestore,xl);return Hh(Ul(n),e._key).then(function(t){return Lp(n,e,t)})})(this._delegate).then(function(t){return new cd(e.firestore,new Kf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},rd.prototype.withConverter=function(t){return new rd(this.firestore,t?this._delegate.withConverter($p.tu(this.firestore,t)):this._delegate.withConverter(null))},rd);function rd(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Hp(t)}function id(t,e,n){return t.message=t.message.replace(e,n),t}function od(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ll(r))return r}return{}}function sd(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Ll(t[0])?t[0]:Ll(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var ad,ud,cd=(Object.defineProperty(wd.prototype,"ref",{get:function(){return new nd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(wd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(wd.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(wd.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),wd.prototype.data=function(t){return this._delegate.data(t)},wd.prototype.get=function(t,e){return this._delegate.get(t,e)},wd.prototype.isEqual=function(t){return Jf(this._delegate,t._delegate)},wd),hd=(n(bd,ud=cd),bd.prototype.data=function(t){return this._delegate.data(t)},bd),ld=(md.prototype.where=function(t,e,n){try{return new md(this.firestore,Zf(this._delegate,(r=n,i=e,o=qf("where",t),new op(o,i,r))))}catch(t){throw id(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},md.prototype.orderBy=function(t,e){try{return new md(this.firestore,Zf(this._delegate,(n=void 0===e?"asc":e,r=qf("orderBy",t),new sp(r,n))))}catch(t){throw id(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},md.prototype.limit=function(t){try{return new md(this.firestore,Zf(this._delegate,(yl("limit",e=t),new ap("limit",e,"F"))))}catch(t){throw id(t,"limit()","Query.limit()")}var e},md.prototype.limitToLast=function(t){try{return new md(this.firestore,Zf(this._delegate,(yl("limitToLast",e=t),new ap("limitToLast",e,"L"))))}catch(t){throw id(t,"limitToLast()","Query.limitToLast()")}var e},md.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new md(this.firestore,Zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw id(t,"startAt()","Query.startAt()")}},md.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new md(this.firestore,Zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new up("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw id(t,"startAfter()","Query.startAfter()")}},md.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new md(this.firestore,Zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw id(t,"endBefore()","Query.endBefore()")}},md.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new md(this.firestore,Zf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new cp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw id(t,"endAt()","Query.endAt()")}},md.prototype.isEqual=function(t){return Rl(this._delegate,t._delegate)},md.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=dl(e,wl);var n=dl(e.firestore,xl),t=Ul(n),r=new Dp(n);return function(n,r){var t=this,i=new Aa;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,lu(i,o,!0)];case 1:return r=t.sent(),e=new rh(o,r.Bn),n=e._o(r.documents),n=e.applyChanges(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=Pc(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Bh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._query).then(function(t){return new Wf(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=dl(e,wl);var n=dl(e.firestore,xl),t=Ul(n),r=new Dp(n);return Wh(t,e._query,{source:"server"}).then(function(t){return new Wf(n,r,e,t)})}:function(e){e=dl(e,wl);var n=dl(e.firestore,xl),t=Ul(n),r=new Dp(n);return $f(e._query),Wh(t,e._query).then(function(t){return new Wf(n,r,e,t)})})(this._delegate).then(function(t){return new pd(e.firestore,new Wf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},md.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=od(t),i=sd(t,function(t){return new pd(e.firestore,new Wf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))});return kp(this._delegate,r,i)},md.prototype.withConverter=function(t){return new md(this.firestore,t?this._delegate.withConverter($p.tu(this.firestore,t)):this._delegate.withConverter(null))},md),fd=(Object.defineProperty(vd.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"doc",{get:function(){return new hd(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),vd),pd=(Object.defineProperty(gd.prototype,"query",{get:function(){return new ld(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(gd.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(t){return new hd(e._firestore,t)})},enumerable:!1,configurable:!0}),gd.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new fd(e._firestore,t)})},gd.prototype.forEach=function(e,n){var r=this;this._delegate.forEach(function(t){e.call(n,new hd(r._firestore,t))})},gd.prototype.isEqual=function(t){return Jf(this._delegate,t._delegate)},gd),dd=(n(yd,ad=ld),Object.defineProperty(yd.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(yd.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new nd(this.firestore,t):null},enumerable:!1,configurable:!0}),yd.prototype.doc=function(t){try{return new nd(this.firestore,void 0===t?Dl(this._delegate):Dl(this._delegate,t))}catch(t){throw id(t,"doc()","CollectionReference.doc()")}},yd.prototype.add=function(t){var e,n,r,i=this;return e=this._delegate,n=t,t=dl(e.firestore,xl),r=Dl(e),n=wp(e.converter,n),Op(t,[sf(of(e.firestore),"addDoc",r._key,n,null!==e.converter,{}).toMutation(r._key,es.exists(!1))]).then(function(){return r}).then(function(t){return new nd(i.firestore,t)})},yd.prototype.isEqual=function(t){return Cl(this._delegate,t._delegate)},yd.prototype.withConverter=function(t){return new yd(this.firestore,t?this._delegate.withConverter($p.tu(this.firestore,t)):this._delegate.withConverter(null))},yd);function yd(t,e){var n=this;return(n=ad.call(this,t,e)||this).firestore=t,n._delegate=e,n}function gd(t,e){this._firestore=t,this._delegate=e}function vd(t,e){this._firestore=t,this._delegate=e}function md(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Hp(t)}function bd(){return null!==ud&&ud.apply(this,arguments)||this}function wd(t,e){this._firestore=t,this._delegate=e}function _d(t){return dl(t,bl)}Td.documentId=function(){return new Td(ni.keyField().canonicalString())},Td.prototype.isEqual=function(t){return(t=m(t))instanceof Bl&&this._delegate._internalPath.isEqual(t._internalPath)},Se=Td,Ed.serverTimestamp=function(){var t=new yf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Ed(t)},Ed.delete=function(){var t=new uf("deleteField");return t._methodName="FieldValue.delete",new Ed(t)},Ed.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gf("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Ed(n)},Ed.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vf("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Ed(n)},Ed.increment=function(t){t=new mf("increment",t);return t._methodName="FieldValue.increment",new Ed(t)},Ed.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},T=Ed;function Ed(t){this._delegate=t}function Td(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Bl.bind.apply(Bl,s([void 0],t)))}function Id(t){return e=this._delegate,s=t,n=Ul(e=dl(e,xl)),t=new Ml,function(n,t,r){var e,i=this,o=(e=s,t=$u(t),e=function(t){if(t instanceof Uint8Array)return Nh(t,void 0);if(t instanceof ArrayBuffer)return Nh(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new Ch(e,t));n.asyncQueue.enqueueAndForget(function(){return y(i,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Eh,[4,Gh(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e._databaseId,t),t;var e,s,n}function Sd(t){var e=this,n=this._delegate,t=t;return function(n,r){var t=this;return n.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Qe.getNamedQuery(t,e)})},[4,Bh(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Ul(n=dl(n,xl)),t).then(function(t){return t?new wl(n,null,t.query):null}).then(function(t){return t?new ld(e,t):null})}var Ad=(Nd.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Nd.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Nd.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Nd.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},Nd);function Nd(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var Dd,Cd,Rd={Firestore:Kp,GeoPoint:Kl,Timestamp:Hr,Blob:Bp,Transaction:Xp,WriteBatch:Jp,DocumentReference:nd,DocumentSnapshot:cd,Query:ld,QueryDocumentSnapshot:hd,QuerySnapshot:pd,CollectionReference:dd,FieldPath:Se,FieldValue:T,setLogLevel:function(t){Or.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(Dd=e.default).INTERNAL.registerComponent(new Ad("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new Kp(e,new xl(e,t),new Gp)},"PUBLIC").setServiceProps(Object.assign({},Rd))),Dd.registerVersion("@firebase/firestore","2.3.0-20214541157"),(Cd=Kp).prototype.loadBundle=Id,Cd.prototype.namedQuery=Sd}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
